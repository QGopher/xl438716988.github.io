<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">



  <title>Completion is more important than perfection</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="分享个人笔记，见证学习历程">
  <meta name="keywords" content="python,scrapy,makedown">
  <meta property="og:type" content="website">
  <meta property="og:title" content="Completion is more important than perfection">
  <meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;index.html">
  <meta property="og:site_name" content="Completion is more important than perfection">
  <meta property="og:description" content="分享个人笔记，见证学习历程">
  <meta property="og:locale" content="en">
  <meta name="twitter:card" content="summary">

  <link rel="alternate" href="/atom.xml" title="Completion is more important than perfection"
    type="application/atom+xml">


  <link rel="icon" href="/favicon.png">


  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">

  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
        <div id="banner"></div>
        <div id="header-outer" class="outer">
          <div id="header-title" class="inner">
            <h1 id="logo-wrap">
              <a href="/" id="logo">Completion is more important than perfection</a>
            </h1>

            <h2 id="subtitle-wrap">
              <a href="/" id="subtitle">David Xiang</a>
            </h2>

          </div>
          <div id="header-inner" class="inner">
            <nav id="main-nav">
              <a id="main-nav-toggle" class="nav-icon"></a>

              <a class="main-nav-link" href="/">Home</a>

              <a class="main-nav-link" href="/archives">Archives</a>

            </nav>
            <nav id="sub-nav">

              <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>

              <a id="nav-search-btn" class="nav-icon" title="Search"></a>
            </nav>
            <div id="search-form-wrap">
              <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input
                  type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit"
                  class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch"
                  value="http://yoursite.com"></form>
            </div>
          </div>
        </div>
      </header>
      <div class="outer">
        <section id="main">

          <article id="post-【面试】 1.php面试（一）" class="article article-type-post" itemscope itemprop="blogPost">
            <div class="article-meta">
              <a href="/2020/01/14/%E3%80%90%E9%9D%A2%E8%AF%95%E3%80%91%201.php%E9%9D%A2%E8%AF%95%EF%BC%88%E4%B8%80%EF%BC%89/"
                class="article-date">
                <time datetime="2020-01-14T09:00:06.037Z" itemprop="datePublished">2020-01-14</time>
              </a>

            </div>
            <div class="article-inner">


              <header class="article-header">


                <h1 itemprop="name">
                  <a class="article-title"
                    href="/2020/01/14/%E3%80%90%E9%9D%A2%E8%AF%95%E3%80%91%201.php%E9%9D%A2%E8%AF%95%EF%BC%88%E4%B8%80%EF%BC%89/">【面试】
                    1.php面试（一）</a>
                </h1>


              </header>

              <div class="article-entry" itemprop="articleBody">

                <p><strong>学习方法与经验交流</strong></p>
                <p><strong><img src="https://img.php.cn/upload/article/000/000/020/5c70c00bb5d76638.jpg"
                      alt="img"></strong></p>
                <p>
                  记得我第一次面试PHP这个岗位的时候，哪个时候刚从学校出来混，不知道啥行情啊，又是零经验的（这里插一句，零经验的，如果你从来都没接触过开发一个完整的，或者半成品的项目，公司一般是不会要的，因为公司招你进去，是要你会帮忙做东西，实现公司的业务与业绩的提升的）。那个时候我就直接说试用期800元了，当然，好多年前的了哈！也是一个相当低的价位的，所以公司直接就要了！！！道理很简单，大家都懂的！
                </p>
                <p>相关推荐：《<a href="https://www.php.cn/toutiao-415519.html" target="_blank"
                    rel="noopener">2019年PHP面试题大汇总（收藏）</a>》</p>
                <p>
                  在公司里做项目，成长是一个过程，提升你自己的学习技能更是一个关键所在的。进入公司之前，你会有一两轮的面试与笔试，做我们这个行业的都是这样，所以除了口语表达能力（能吹）之外，还有一点就是实力能力的，这个也是你的面试题所要体现的。面试题的题型很多，但是都是离不开PHP基础的。一些刚出来的可能不懂试题的。告诉你一个方法，那个时候我真的用了！就是把所有题型都背下来了！方法很老套又不切合实际。但是很有用，因为常见的题型都遇到了~~可能是幸运吧！
                </p>
                <p>可能学习各有各的方法！我以前就是那样子过来的！现在呢，还是要继续的学习与提升技能，活到老学到老！一旦进坑了，很难出来！</p>
                <p>以下推荐一些面试常见的试题，希望对你有用！！</p>
                <p><strong>1、冒泡排序，面试前一定要记住哦！</strong></p>
                <figure class="highlight php">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">maopao</span><span class="params">($arr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $len = count($arr);</span><br><span class="line">    $n = count($arr) - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; $len; $i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> ($j = <span class="number">0</span>; $j &lt; $n; $j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> ($arr[$j] &gt; $arr[$j + <span class="number">1</span>]) &#123;</span><br><span class="line">                $tmp = $arr[$j];</span><br><span class="line">                $arr[$j] = $arr[$j + <span class="number">1</span>];</span><br><span class="line">                $arr[$j + <span class="number">1</span>] = $tmp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $arr;</span><br><span class="line">&#125;</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <p><strong>2、快速排序，面试前一定要记住哦！</strong></p>
                <figure class="highlight php">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">quick_sort</span><span class="params">($array)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (count($array) &lt;= <span class="number">1</span>) <span class="keyword">return</span> $array;</span><br><span class="line">    $key = $array[<span class="number">0</span>];</span><br><span class="line">    $left_arr = <span class="keyword">array</span>();</span><br><span class="line">    $right_arr = <span class="keyword">array</span>();</span><br><span class="line">    <span class="keyword">for</span> ($i=<span class="number">1</span>; $i&lt;count($array); $i++)&#123;</span><br><span class="line">        <span class="keyword">if</span> ($array[$i] &lt;= $key)</span><br><span class="line">            $left_arr[] = $array[$i];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            $right_arr[] = $array[$i];</span><br><span class="line">    &#125;</span><br><span class="line">    $left_arr = quick_sort($left_arr);</span><br><span class="line">    $right_arr = quick_sort($right_arr);</span><br><span class="line">    <span class="keyword">return</span> array_merge($left_arr, <span class="keyword">array</span>($key), $right_arr);</span><br><span class="line">&#125;</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <p><strong>3、请说明 PHP 中传值与传引用的区别，什么时候传值什么时候传引用?</strong></p>
                <p>按值传递：函数范围内对值的任何改变在函数外部都会被忽略</p>
                <p>按引用传递：函数范围内对值的任何改变在函数外部也能反映出这些修改</p>
                <p>优缺点：按值传递时，php必须复制值。特别是对于大型的字符串和对象来说，这将会是一个代价很大的操作。按引用传递则不需要复制值，对于性能提高很有好处。（优缺点会考到）</p>
                <p><strong>4、MySQL数据库中的字段类型varchar和char的主要区别是什么?</strong></p>
                <p>Varchar是变长，节省存储空间，char是固定长度。查找效率要char型快，因为varchar是非定长，必须先查找长度，然后进行数据的提取，比char定长类型多了一个步骤，所以效率低一些。</p>
                <p><strong>5、MySQL数据库的常用存储引擎以及它们的区别？</strong></p>
                <p>MyISAM：不支持事务，表锁，易产生碎片，要经常优化，读写速度较快，支持全文索引。</p>
                <p>InnoDB：支持事务，行锁，有崩溃恢复能力。读写速度比MyISAM慢，5.6之后支持全文索引。<br>存储引擎是基于表的，而不是数据库</p>
                <p>（这道题还能更详细点就详细点）</p>
                <p><strong>6、对于大流量的网站，采用什么样的方法来解决访问量问题？</strong></p>
                <p>首先，确认服务器硬件是否足够支持当前的流量</p>
                <p>其次，优化数据库访问。</p>
                <p>第三，禁止外部的盗链。</p>
                <p>第四，控制大文件的下载。</p>
                <p>第五，使用不同主机分流主要流量</p>
                <p>第六，使用流量分析统计软件</p>
                <p>第七，尽量使用静态页，缓存</p>
                <p><strong>7、什么是面向对象？主要特征是什么？</strong></p>
                <p>面向对象是程序的一种设计方式，它利于提高程序的重用性，使程序结构更加清晰。主要特征：封装、继承、多态。</p>
                <p><strong>8、SESSION 与 COOKIE的区别是什么？这是重点</strong></p>
                <p>
                  SESSION存储在服务器端，COOKIE保存在客户端。Session比较安全，cookie用某些手段可以修改，不安全。Session依赖于cookie进行传递。禁用cookie后，session还可以使用，在存储session的文件中，生成sessionID，通过get传参的方式将sessionID传到要实现session共享的页面，读取sessionID,从而从session中获取数据。
                </p>
                <p>建议查找session与cookie这方面的详细教程</p>
                <p><strong>9、对缓存技术的了解？redis是个考点</strong></p>
                <p>1、缓存技术是将动态内容缓存到文件中，在一定时间内访问动态页面直接调用缓存文件，而不必重新访问数据库。</p>
                <p>2、使用memcache可以做缓存。</p>
                <p><strong>10、表单中get和post提交方式的区别</strong></p>
                <p>get是显式的，数据从url中可以看到，传输的数据量小，安全性低；</p>
                <p>post是隐式的，传送的数据量较大，安全性较高</p>
                <p><strong>11、优化数据库的方法</strong></p>
                <p>选取最适用的字段属性，尽可能减少定义字段宽度，尽量把字段设置NOTNULL</p>
                <p>使用连接(JOIN)来代替子查询</p>
                <p>适用联合(UNION)来代替手动创建的临时表</p>
                <p>事务处理</p>
                <p>锁定表、优化事务处理</p>
                <p>使用外键，优化锁定表</p>
                <p>使用索引</p>
                <p>优化查询语句</p>
                <p><strong>12、语句include和require的区别是什么？语句include和require的区别是什么？</strong></p>
                <p>require是无条件包含，也就是如果一个流程里加入require，无论条件成立与否都会先执行require，当文件不存在或者无法打开的时候，会提示错误，并且会终止程序执行</p>
                <p>include有返回值，而require没有(可能因为如此require的速度比include快)，如果被包含的文件不存在的化，那么会提示一个错误，但是程序会继续执行下去</p>
                <p><strong>13、redis和memcacahe、mongoDB的区别？</strong></p>
                <p>都是非关系型数据库，性能都非常高，但是mongoDB和memcache、redis是不同的两种类型。后两者主要用于数据的缓存，前者主要用在查询和储存大数据方面，是最接近数据库的文档型的非关系数据库。
                </p>
                <p>
                  从数据存储位置上来分，memcache的数据存在内存中，而redis既可以存储在内存中，也可以存储的到磁盘中，达到持久化存储的功能，memcache一旦断电，数据全部丢失，redis可以利用快照和AOF把数据存到磁盘中，当恢复时又从磁盘中读取到内存中，当物理内存使用完毕后，可以把数据写入到磁盘中。
                </p>
                <p>
                  从存储数据的类型上来分，memcache和redis存储的方式都是键值对，只不过redis值的类型比较丰富，有string(字符串),hash(哈希)，list(列表),set(集合)zset(有序集合)，而memcache主要存储的是字符串。
                </p>
                <p><strong>14、PHP的基本变量类型</strong></p>
                <p>四种标量类型：boolean （布尔型）、integer （整型）、float （浮点型, 也称作 double)、string （字符串）</p>
                <p>两种复合类型：array （数组）、object （对象）</p>
                <p>最后是两种特殊类型：resource（资源）、NULL（NULL）</p>
                <p><strong>15、静态化如何实现的？伪静态如何实现？</strong></p>
                <p>1、 静态化指的是页面静态化，也即生成实实在在的静态文件，也即不需要查询数据库就可以直接从文件中获取数据，指的是真静态。<br>实现方式主要有两种：</p>
                <p>一种是我们在添加信息入库的时候就生成的静态文件，也称为模板替换技术。</p>
                <p>一种是用户在访问我们的页面时先判断是否有对应的缓存文件存在，如果存在就读缓存，不存在就读数据库，同时生成缓存文件。</p>
                <p>
                  2、伪静态不是真正意义上的静态化，之所以使用伪静态，主要是为了SEO推广，搜索引擎对动态的文件获取难度大，不利于网站的推广。实习原理是基于Apache或Nginx的rewrite机智<br>主要有两种方式：
                </p>
                <p>一种是直接在配置虚拟机的位置配置伪静态，这个每次修改完成后需要重启web服务器。</p>
                <p>另一种采用分布式的，可以在网站的根目录上创建.htaccess的文件，在里面配置相应的重写规则来实现伪静态，这种每次重写时不需要重启web服务器，且结构上比较清晰。</p>
                <p><strong>16、Mysql的读写分离?（进阶的会遇到）</strong></p>
                <p>
                  读写分离的实现原理就是在执行SQL语句的时候，判断到底是读操作还是写操作，把读的操作转向到读服务器上（从服务器，一般是多台），写的操作转到写的服务器上（主服务器，一般是一台，视数据量来看）。当然为了保证多台数据库数据的一致性，需要主从复制。
                </p>
                <p><strong>17、如何处理负载，高并发？</strong></p>
                <p>1、HTML静态化<br>效率最高、消耗最小的就是纯静态化的html页面，所以我们尽可能使我们的
                  网站上的页面采用静态页面来实现，这个最简单的方法其实也是最有效的方法。<br>2、图片服务器分离<br>把图片单独存储，尽量减少图片等大流量的开销，可以放在一些相关的平台上，如七牛等<br>3、数据库集群和库表散列及缓存<br>数据库的并发连接为100，一台数据库远远不够，可以从读写分离、主从复制，数据库集群方面来着手。另外尽量减少数据库的访问，可以使用缓存数据库如memcache、redis。<br>4、镜像：<br>尽量减少下载，可以把不同的请求分发到多个镜像端。<br>5、负载均衡：<br>Apache的最大并发连接为1500，只能增加服务器，可以从硬件上着手，如F5服务器。当然硬件的成本比较高，我们往往从软件方面着手。
                </p>
                <p><strong>18、说一下单引号双引号？（基础考点）</strong></p>
                <p>单引号内部的变量不会执行， 双引号会执行</p>
                <p>单引号解析速度比双引号快。</p>
                <p>单引号只能解析部分特殊字符，双引号可以解析所有特殊字符。</p>
                <p><strong>19、PHP7的新特性？重点</strong></p>
                <p>标量类型声明：PHP 7 中的函数的形参类型声明可以是标量了。在 PHP 5 中只能是类名、接口、array 或者 callable (PHP 5.4，即可以是函数，包括匿名函数)，现在也可以使用
                  string、int、float和 bool 了。</p>
                <p>返回值类型声明：增加了对返回类型声明的支持。 类似于参数类型声明，返回类型声明指明了函数返回值的类型。可用的类型与参数声明中可用的类型相同。</p>
                <p>NULL 合并运算符：由于日常使用中存在大量同时使用三元表达式和 isset()的情况，NULL 合并运算符使得变量存在且值不为NULL， 它就会返回自身的值，否则返回它的第二个操作数。</p>
                <p>use 加强：从同一 namespace 导入的类、函数和常量现在可以通过单个 use 语句 一次性导入了</p>
                <p>匿名类：现在支持通过new class 来实例化一个匿名类</p>
                <p><strong>20、PHP 数组排序</strong></p>
                <p>sort() - 以升序对数组排序</p>
                <p>rsort() - 以降序对数组排序</p>
                <p>asort() - 根据值，以升序对关联数组进行排序</p>
                <p>ksort() - 根据键，以升序对关联数组进行排序</p>
                <p>arsort() - 根据值，以降序对关联数组进行排序</p>
                <p>krsort() - 根据键，以降序对关联数组进行排序</p>
                <p><strong>21、建立索引</strong></p>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">(普通索引)-&gt;</span><br><span class="line">创建:CREATE INDEX &lt;索引名&gt; ON tablename (索引字段)</span><br><span class="line">修改:ALTER TABLE tablename ADD INDEX [索引名] (索引字段)</span><br><span class="line">创表指定索引:CREATE TABLE tablename([...],INDEX[索引名](索引字段))</span><br><span class="line">(唯一索引)-&gt;</span><br><span class="line">创建:CREATE UNIQUE &lt;索引名&gt; ON tablename (索引字段)</span><br><span class="line">修改:ALTER TABLE tablename ADD UNIQUE [索引名] (索引字段)</span><br><span class="line">创表指定索引:CREATE TABLE tablename([...],UNIQUE[索引名](索引字段))</span><br><span class="line">(主键)-&gt;</span><br><span class="line">它是唯一索引,一般在创建表是建立,格式为:</span><br><span class="line">CREATA TABLE tablename ([...],PRIMARY KEY[索引字段])</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <p><strong>22、PHP支持多继承吗？</strong></p>
                <p>不支持。PHP中只允许单继承，父类可以被一个子类用关键字“extends”继承。</p>
                <p><strong>23、使用过Memcache缓存吗，如果使用过，能够简单的描述一下它的工作原理吗？</strong></p>
                <p>
                  Memcahce是把所有的数据保存在内存当中，采用hash表的方式，每条数据又key和value组成，每个key是独一无二的，当要访问某个值的时候先按照找到值，然后返回结果。<br>Memcahce采用LRU算法来逐渐把过期数据清除掉。
                </p>
                <p><strong>24、优化MYSQL数据库的方法</strong></p>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">（1）选择最有效率的表名顺序</span><br><span class="line">（2）WHERE子句中的连接顺序</span><br><span class="line">（3）SELECT子句中避免使用‘*’</span><br><span class="line">（4）用Where子句替换HAVING子句</span><br><span class="line">（5）通过内部函数提高SQL效率</span><br><span class="line">（6）避免在索引列上使用计算。</span><br><span class="line">（7）提高GROUP BY 语句的效率, 可以通过将不需要的记录在GROUP BY 之前过滤掉。</span><br><span class="line"> </span><br><span class="line">(1).选取最适用的字段属性,应该尽量把字段设置为NOT NULL</span><br><span class="line">(2).使用连接（JOIN）来代替子查询(Sub-Queries)</span><br><span class="line">(3).使用联合(UNION)来代替手动创建的临时表</span><br><span class="line">(4).尽量少使用 LIKE 关键字和通配符</span><br><span class="line">(5).使用事务和外键</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <p><strong>25、MySQL主从备份的原理？</strong></p>
                <p>mysql支持单向、异步复制，复制过程中一个服务器充当主服务器，而一个或多个其它服务器充当从服务器。</p>
                <p><strong>26、error_reporting() 的作用？</strong></p>
                <p>设置 PHP 的报错级别并返回当前级别。</p>
                <p><strong>27、如何修改session的生存时间</strong></p>
                <p>在php.ini 中设置 session.gc_maxlifetime = 1440 //默认时间</p>
                <p>代码实现</p>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">$lifeTime = 24 * 3600;  // 保存一天 </span><br><span class="line">session_set_cookie_params($lifeTime); </span><br><span class="line">session_start();</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <p><strong>28、常见的 PHP 安全性攻击</strong></p>
                <p><strong>SQL注入</strong>：用户利用在表单字段输入SQL语句的方式来影响正常的SQL执行。<br><strong>防止</strong>：</p>
                <p>使用mysql_real_escape_string()过滤数据</p>
                <p>手动检查每一数据是否为正确的数据类型</p>
                <p>使用预处理语句并绑定变量</p>
                <p>参数化SQL：是指在设计与数据库链接并访问数据时，在需要填入数值或数据的地方，使用参数 (Parameter) 来给值，用@或？来表示参数。</p>
                <p><strong>XSS攻击</strong>
                  ：跨站点脚本攻击，由用户输入一些数据到你的网站，其中包括客户端脚本(通常JavaScript)。如果你没有过滤就输出数据到另一个web页面，这个脚本将被执行。<br><strong>防止</strong>：为了防止XSS攻击，使用PHP的htmlentities()函数过滤再输出到浏览器。
                </p>
                <p>
                  <strong>CSRF</strong>：跨站点请求伪造，是指一个页面发出的请求，看起来就像是网站的信任用户，但是是伪造的<br><strong>防止</strong>：一般来说，确保用户来自你的表单，并且匹配每一个你发送出去的表单。有两点一定要记住：
                </p>
                <p>对用户会话采用适当的安全措施，例如:给每一个会话更新id和用户使用SSL。</p>
                <p>生成另一个一次性的令牌并将其嵌入表单，保存在会话中(一个会话变量)，在提交时检查它。 如laravel中的 _token</p>
                <p>
                  <strong>代码注入</strong>：代码注入是利用计算机漏洞通过处理无效数据造成的。问题出在，当你不小心执行任意代码，通常通过文件包含。写得很糟糕的代码可以允许一个远程文件包含并执行。如许多PHP函数，如require可以包含URL或文件名。<br>防止代码注入
                </p>
                <p><strong>过滤用户输入</strong></p>
                <p>在php.ini中设置禁用allow_url_fopen和allow_url_include。这将禁用require/include/fopen的远程文件</p>
                <p>题型还有很多，希望大家在学习过程中，慢慢的去发现和慢慢的提升自己的学习技能，最后祝大家学习愉快！！</p>


              </div>
              <footer class="article-footer">
                <a data-url="http://yoursite.com/2020/01/14/%E3%80%90%E9%9D%A2%E8%AF%95%E3%80%91%201.php%E9%9D%A2%E8%AF%95%EF%BC%88%E4%B8%80%EF%BC%89/"
                  data-id="ck5dnjjlp0008qgts0flidzlu" class="article-share-link">Share</a>


              </footer>
            </div>

          </article>



          <article id="post-【运维】 1.入门学习" class="article article-type-post" itemscope itemprop="blogPost">
            <div class="article-meta">
              <a href="/2019/12/13/%E3%80%90%E8%BF%90%E7%BB%B4%E3%80%91%201.%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0/"
                class="article-date">
                <time datetime="2019-12-13T03:55:41.890Z" itemprop="datePublished">2019-12-13</time>
              </a>

            </div>
            <div class="article-inner">


              <header class="article-header">


                <h1 itemprop="name">
                  <a class="article-title"
                    href="/2019/12/13/%E3%80%90%E8%BF%90%E7%BB%B4%E3%80%91%201.%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0/">【运维】
                    1.入门学习</a>
                </h1>


              </header>

              <div class="article-entry" itemprop="articleBody">

                <h3 id="CentOS7-安装svn"><a href="#CentOS7-安装svn" class="headerlink" title="CentOS7 安装svn"></a>CentOS7
                  安装svn</h3>
                <ol>
                  <li>安装</li>
                </ol>
                <ul>
                  <li>CentOS7下yum命令即可方便的完成安装</li>
                </ul>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">$ sudo yum install subversion</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>



                <ul>
                  <li>测试安装是否成功：</li>
                </ul>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">$ svnserve --version</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>



                <ol start="2">
                  <li>建立版本库</li>
                </ol>
                <ul>
                  <li>
                    <p>创建svn数据目录（subversion默认是把/var/svn作为数据根目录的，开机启动默认也是从这里）：</p>
                    <figure class="highlight plain">
                      <table>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line">$ sudo mkdir -p /var/svn</span><br></pre>
                          </td>
                        </tr>
                      </table>
                    </figure>



                  </li>
                </ul>
                <ul>
                  <li>
                    <p>创建版本库：</p>
                    <figure class="highlight plain">
                      <table>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line">$ sudo svnadmin create /var/svn/wangwa</span><br></pre>
                          </td>
                        </tr>
                      </table>
                    </figure>





                  </li>
                </ul>
                <ul>
                  <li>如果删除版本库：</li>
                </ul>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">$ sudo rm -rf /var/svn/somnus</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>



                <ol start="3">
                  <li>配置svn配置文件</li>
                </ol>
                <p>每个版本库创建之后都会生成svnserve.conf主要配置文件。编辑它：</p>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">$ sudo vim /var/svn/somnus/conf/svnserve.conf</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <p>编辑示例：</p>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">[general]</span><br><span class="line">anon-access = none                #控制非鉴权用户访问版本库的权限</span><br><span class="line">auth-access = write                 #控制鉴权用户访问版本库的权限</span><br><span class="line">password-db = passwd           #指定用户名口令文件名</span><br><span class="line">authz-db = authz                     #指定权限配置文件名</span><br><span class="line">realm = somnus               #指定版本库的认证域，即在登录时提示的认证域名称</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>



                <ol start="4">
                  <li>编辑svn用户配置文件</li>
                </ol>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">sudo vim /var/svn/somnus/conf/passwd</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <p>编辑示例：</p>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">[users]</span><br><span class="line">admin = admin                #用户，密码</span><br><span class="line">fuhd = fuhd                #用户，密码</span><br><span class="line">test = test                #用户，密码</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>



                <ol start="5">
                  <li>编辑svn权限控制配置文件</li>
                </ol>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">sudo vim /var/svn/somnus/conf/authz</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <p>编辑示例：</p>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">[groups]</span><br><span class="line">admin = admin         #admin为用户组,等号之后的admin为用户</span><br><span class="line">test = fuhd,test</span><br><span class="line"></span><br><span class="line">[somnus:/]                #表示根目录（/var/svn/somnus），somnus: 对应前面配置的realm = somnus</span><br><span class="line">@admin = rw            ＃表示admin组对根目录有读写权限,r为读，w为写</span><br><span class="line"></span><br><span class="line">[somnus:/test]         #表示test目录（/var/svn/somnus/test）</span><br><span class="line">@test = rw                #表示test组对test目录有读写权限</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>



                <ol start="6">
                  <li>启动，查看和停止SVN服务</li>
                </ol>
                <ul>
                  <li>
                    <p>启动SVN服务：</p>
                    <figure class="highlight plain">
                      <table>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line">#-d : 守护进程  -r : svn数据根目录 </span><br><span class="line">$ sudo svnserve -dr /var/svn            #用root权限启动</span><br></pre>
                          </td>
                        </tr>
                      </table>
                    </figure>





                  </li>
                </ul>
                <ul>
                  <li>查看SVN服务：</li>
                </ul>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">$ ps aux|grep svns erve               #默认端口为：3690</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>



                <ol start="7">
                  <li>配置防火墙端口</li>
                </ol>
                <p>首先要明确CentOS7的默认防火墙为firewallD。subversion的默认端口为3690，如果没有打开会报错：</p>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">$ sudo firewall-cmd --permanent -add-port=3690/tcp</span><br><span class="line"> $ sudo firewall-cmd --reload</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>




                <ol start="8">
                  <li>检索项目和切换项目的url</li>
                </ol>
                <ul>
                  <li>项目检错</li>
                </ul>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">$ svn checkout svn://192.168.0.112/XK_Project . #使用 checkout  服务器资源 本地目录</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <ul>
                  <li>切换项目url</li>
                </ul>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">$ svn switch --relocate svn://192.168.0.112/XK_Project svn://192.168.0.120/XK_Project   # 使用 switch 迁移 from  to 新的地址</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>




                <ol start="9">
                  <li>设置开机启动</li>
                </ol>
                <p>在centos7， 设置开机启动：</p>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">$ sudo systemctl enable svnserve.service      #注意：根目录必须是/var/svn 这样才能设置成功！！</span><br><span class="line">#设置开机启动后就可以按下面的方式开启或停止服务了</span><br><span class="line">$ sudo systemctl start svnserve.service</span><br><span class="line">$ sudo systemctl stop svnserve.service</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <p>临时关闭：</p>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">$ sudo setenforce 0</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <p>永久关闭：</p>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">$ sudo vim /etc/sysconfig/selinux</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>


                <p>修改：</p>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">SELINUX = disable               #值修改为disable.</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>




              </div>
              <footer class="article-footer">
                <a data-url="http://yoursite.com/2019/12/13/%E3%80%90%E8%BF%90%E7%BB%B4%E3%80%91%201.%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0/"
                  data-id="ck5dnjjlb0007qgtscbwadzv2" class="article-share-link">Share</a>


              </footer>
            </div>

          </article>



          <article id="post-【mysql】 2.mysql基础入门(全)" class="article article-type-post" itemscope itemprop="blogPost">
            <div class="article-meta">
              <a href="/2019/12/07/%E3%80%90mysql%E3%80%91%202.mysql%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8(%E5%85%A8)/"
                class="article-date">
                <time datetime="2019-12-07T01:58:55.909Z" itemprop="datePublished">2019-12-07</time>
              </a>

            </div>
            <div class="article-inner">


              <header class="article-header">


                <h1 itemprop="name">
                  <a class="article-title"
                    href="/2019/12/07/%E3%80%90mysql%E3%80%91%202.mysql%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8(%E5%85%A8)/">【mysql】
                    2.mysql基础入门(全)</a>
                </h1>


              </header>

              <div class="article-entry" itemprop="articleBody">

                <p>##本单元目标<br> 一、为什么要学习数据库<br> 二、数据库的相关概念<br> DBMS、DB、SQL<br> 三、数据库存储数据的特点<br> 四、初始MySQL<br>
                  MySQL产品的介绍<br> MySQL产品的安装 ★<br> MySQL服务的启动和停止 ★<br> MySQL服务的登录和退出 ★<br> MySQL的常见命令和语法规范<br> 五、DQL语言的学习
                  ★<br> 基础查询 ★<br> 条件查询 ★<br> 排序查询 ★<br> 常见函数 ★<br> 分组函数 ★<br> 分组查询 ★<br> 连接查询 ★<br> 子查询 √<br> 分页查询
                  ★<br> union联合查询 √ </p>
                <pre><code>六、DML语言的学习    ★             
    插入语句                        
    修改语句                        
    删除语句                        
七、DDL语言的学习  
    库和表的管理     √                
    常见数据类型介绍  √          
    常见约束        √            
八、TCL语言的学习
    事务和事务处理                 
九、视图的讲解           √
十、变量                      
十一、存储过程和函数   
十二、流程控制结构       </code></pre>
                <p>##数据库的好处<br> 1.持久化数据到本地<br> 2.可以实现结构化查询，方便管理</p>
                <p>##数据库相关概念<br> 1、DB：数据库，保存一组有组织的数据的容器<br> 2、DBMS：数据库管理系统，又称为数据库软件（产品），用于管理DB中的数据<br>
                  3、SQL:结构化查询语言，用于和DBMS通信的语言</p>
                <p>##数据库存储数据的特点<br> 1、将数据放到表中，表再放到库中<br> 2、一个数据库中可以有多个表，每个表都有一个的名字，用来标识自己。表名具有唯一性。<br>
                  3、表具有一些特性，这些特性定义了数据在表中如何存储，类似java中 “类”的设计。<br> 4、表由列组成，我们也称为字段。所有表都是由一个或多个列组成的，每一列类似java 中的”属性”<br>
                  5、表中的数据是按行存储的，每一行类似于java中的“对象”。</p>
                <p>##MySQL产品的介绍和安装</p>
                <p>###MySQL服务的启动和停止<br> 方式一：计算机——右击管理——服务<br> 方式二：通过管理员身份运行<br> net start 服务名（启动服务）<br> net stop
                  服务名（停止服务）</p>
                <p>###MySQL服务的登录和退出<br> 方式一：通过mysql自带的客户端<br> 只限于root用户</p>
                <pre><code>方式二：通过windows自带的客户端
登录：
mysql 【-h主机名 -P端口号 】-u用户名 -p密码

退出：
exit或ctrl+C</code></pre>
                <p>###MySQL的常见命令 </p>
                <pre><code>1.查看当前所有的数据库
show databases;
2.打开指定的库
use 库名
3.查看当前库的所有表
show tables;
4.查看其它库的所有表
show tables from 库名;
5.创建表
create table 表名(

    列名 列类型,
    列名 列类型，
    。。。
);
6.查看表结构
desc 表名;


7.查看服务器的版本
方式一：登录到mysql服务端
select version();
方式二：没有登录到mysql服务端
mysql --version
或
mysql --V</code></pre>
                <p>###MySQL的语法规范<br> 1.不区分大小写,但建议关键字大写，表名、列名小写<br> 2.每条命令最好用分号结尾<br> 3.每条命令根据需要，可以进行缩进 或换行<br> 4.注释<br>
                  单行注释：#注释文字<br> 单行注释：– 注释文字<br> 多行注释：/* 注释文字 */</p>
                <p>###SQL的语言分类<br> DQL（Data Query Language）：数据查询语言<br> select<br> DML(Data Manipulate
                  Language):数据操作语言<br> insert 、update、delete<br> DDL（Data Define Languge）：数据定义语言<br>
                  create、drop、alter<br> TCL（Transaction Control Language）：事务控制语言<br> commit、rollback</p>
                <p>###SQL的常见命令</p>
                <pre><code>show databases； 查看所有的数据库
use 库名； 打开指定 的库
show tables ; 显示库中的所有表
show tables from 库名;显示指定库中的所有表
create table 表名(
    字段名 字段类型,    
    字段名 字段类型
); 创建表

desc 表名; 查看指定表的结构
select * from 表名;显示表中的所有数据</code></pre>
                <p>##DQL语言的学习<br>###进阶1：基础查询<br> 语法：<br> SELECT 要查询的东西<br> 【FROM 表名】;</p>
                <pre><code>类似于Java中 :System.out.println(要打印的东西);
特点：
①通过select查询完的结果 ，是一个虚拟的表格，不是真实存在
② 要查询的东西 可以是常量值、可以是表达式、可以是字段、可以是函数</code></pre>
                <p>###进阶2：条件查询<br> 条件查询：根据条件过滤原始表的数据，查询到想要的数据<br> 语法：<br> select<br> 要查询的字段|表达式|常量值|函数<br> from<br>
                  表<br> where<br> 条件 ;</p>
                <pre><code>分类：
一、条件表达式
    示例：salary&gt;10000
    条件运算符：
    &gt; &lt; &gt;= &lt;= = != &lt;&gt;

二、逻辑表达式
示例：salary&gt;10000 &amp;&amp; salary&lt;20000

逻辑运算符：

    and（&amp;&amp;）:两个条件如果同时成立，结果为true，否则为false
    or(||)：两个条件只要有一个成立，结果为true，否则为false
    not(!)：如果条件成立，则not后为false，否则为true

三、模糊查询
示例：last_name like &apos;a%&apos;</code></pre>
                <p>###进阶3：排序查询 </p>
                <pre><code>语法：
select
    要查询的东西
from
    表
where 
    条件

order by 排序的字段|表达式|函数|别名 【asc|desc】</code></pre>
                <p>###进阶4：常见函数<br> 一、单行函数<br> 1、字符函数<br> concat拼接<br> substr截取子串<br> upper转换成大写<br> lower转换成小写<br>
                  trim去前后指定的空格和字符<br> ltrim去左边空格<br> rtrim去右边空格<br> replace替换<br> lpad左填充<br> rpad右填充<br>
                  instr返回子串第一次出现的索引<br> length 获取字节个数</p>
                <pre><code>2、数学函数
    round 四舍五入
    rand 随机数
    floor向下取整
    ceil向上取整
    mod取余
    truncate截断
3、日期函数
    now当前系统日期+时间
    curdate当前系统日期
    curtime当前系统时间
    str_to_date 将字符转换成日期
    date_format将日期转换成字符
4、流程控制函数
    if 处理双分支
    case语句 处理多分支
        情况1：处理等值判断
        情况2：处理条件判断

5、其他函数
    version版本
    database当前库
    user当前连接用户</code></pre>
                <p>二、分组函数</p>
                <pre><code>sum 求和
max 最大值
min 最小值
avg 平均值
count 计数

特点：
1、以上五个分组函数都忽略null值，除了count(*)
2、sum和avg一般用于处理数值型
    max、min、count可以处理任何数据类型
3、都可以搭配distinct使用，用于统计去重后的结果
4、count的参数可以支持：
    字段、*、常量值，一般放1

   建议使用 count(*)</code></pre>
                <p>##进阶5：分组查询<br> 语法：<br> select 查询的字段，分组函数<br> from 表<br> group by 分组的字段</p>
                <pre><code>特点：
1、可以按单个字段分组
2、和分组函数一同查询的字段最好是分组后的字段
3、分组筛选
        针对的表    位置            关键字
分组前筛选：    原始表        group by的前面        where
分组后筛选：    分组后的结果集    group by的后面        having

4、可以按多个字段分组，字段之间用逗号隔开
5、可以支持排序
6、having后可以支持别名</code></pre>
                <p>##进阶6：多表连接查询</p>
                <pre><code>笛卡尔乘积：如果连接条件省略或无效则会出现
解决办法：添加上连接条件</code></pre>
                <p>一、传统模式下的连接 ：等值连接——非等值连接</p>
                <pre><code>1.等值连接的结果 = 多个表的交集
2.n表连接，至少需要n-1个连接条件
3.多个表不分主次，没有顺序要求
4.一般为表起别名，提高阅读性和性能</code></pre>
                <p>二、sql99语法：通过join关键字实现连接</p>
                <pre><code>含义：1999年推出的sql语法
支持：
等值连接、非等值连接 （内连接）
外连接
交叉连接

语法：

select 字段，...
from 表1
【inner|left outer|right outer|cross】join 表2 on  连接条件
【inner|left outer|right outer|cross】join 表3 on  连接条件
【where 筛选条件】
【group by 分组字段】
【having 分组后的筛选条件】
【order by 排序的字段或表达式】

好处：语句上，连接条件和筛选条件实现了分离，简洁明了！</code></pre>
                <p>三、自连接</p>
                <p>案例：查询员工名和直接上级的名称</p>
                <p>sql99</p>
                <pre><code>SELECT e.last_name,m.last_name
FROM employees e
JOIN employees m ON e.`manager_id`=m.`employee_id`;</code></pre>
                <p>sql92</p>
                <pre><code>SELECT e.last_name,m.last_name
FROM employees e,employees m 
WHERE e.`manager_id`=m.`employee_id`;</code></pre>
                <p>##进阶7：子查询</p>
                <p>含义：</p>
                <pre><code>一条查询语句中又嵌套了另一条完整的select语句，其中被嵌套的select语句，称为子查询或内查询
在外面的查询语句，称为主查询或外查询</code></pre>
                <p>特点：</p>
                <pre><code>1、子查询都放在小括号内
2、子查询可以放在from后面、select后面、where后面、having后面，但一般放在条件的右侧
3、子查询优先于主查询执行，主查询使用了子查询的执行结果
4、子查询根据查询结果的行数不同分为以下两类：
① 单行子查询
    结果集只有一行
    一般搭配单行操作符使用：&gt; &lt; = &lt;&gt; &gt;= &lt;= 
    非法使用子查询的情况：
    a、子查询的结果为一组值
    b、子查询的结果为空

② 多行子查询
    结果集有多行
    一般搭配多行操作符使用：any、all、in、not in
    in： 属于子查询结果中的任意一个就行
    any和all往往可以用其他查询代替</code></pre>
                <p>##进阶8：分页查询</p>
                <p>应用场景：</p>
                <pre><code>实际的web项目中需要根据用户的需求提交对应的分页查询的sql语句</code></pre>
                <p>语法：</p>
                <pre><code>select 字段|表达式,...
from 表
【where 条件】
【group by 分组字段】
【having 条件】
【order by 排序的字段】
limit 【起始的条目索引，】条目数;</code></pre>
                <p>特点：</p>
                <pre><code>1.起始条目索引从0开始

2.limit子句放在查询语句的最后

3.公式：select * from  表 limit （page-1）*sizePerPage,sizePerPage
假如:
每页显示条目数sizePerPage
要显示的页数 page</code></pre>
                <p>##进阶9：联合查询</p>
                <p>引入：<br> union 联合、合并</p>
                <p>语法：</p>
                <pre><code>select 字段|常量|表达式|函数 【from 表】 【where 条件】 union 【all】
select 字段|常量|表达式|函数 【from 表】 【where 条件】 union 【all】
select 字段|常量|表达式|函数 【from 表】 【where 条件】 union  【all】
.....
select 字段|常量|表达式|函数 【from 表】 【where 条件】</code></pre>
                <p>特点：</p>
                <pre><code>1、多条查询语句的查询的列数必须是一致的
2、多条查询语句的查询的列的类型几乎相同
3、union代表去重，union all代表不去重</code></pre>
                <p>##DML语言</p>
                <p>###插入</p>
                <p>语法：<br> insert into 表名(字段名，…)<br> values(值1，…);</p>
                <p>特点：</p>
                <pre><code>1、字段类型和值类型一致或兼容，而且一一对应
2、可以为空的字段，可以不用插入值，或用null填充
3、不可以为空的字段，必须插入值
4、字段个数和值的个数必须一致
5、字段可以省略，但默认所有字段，并且顺序和表中的存储顺序一致</code></pre>
                <p>###修改</p>
                <p>修改单表语法：</p>
                <pre><code>update 表名 set 字段=新值,字段=新值
【where 条件】</code></pre>
                <p>修改多表语法：</p>
                <pre><code>update 表1 别名1,表2 别名2
set 字段=新值，字段=新值
where 连接条件
and 筛选条件</code></pre>
                <p>###删除</p>
                <p>方式1：delete语句 </p>
                <p>单表的删除： ★<br> delete from 表名 【where 筛选条件】</p>
                <p>多表的删除：<br> delete 别名1，别名2<br> from 表1 别名1，表2 别名2<br> where 连接条件<br> and 筛选条件;</p>
                <p>方式2：truncate语句</p>
                <pre><code>truncate table 表名</code></pre>
                <p>两种方式的区别【面试题】</p>
                <pre><code>#1.truncate不能加where条件，而delete可以加where条件

#2.truncate的效率高一丢丢

#3.truncate 删除带自增长的列的表后，如果再插入数据，数据从1开始
#delete 删除带自增长列的表后，如果再插入数据，数据从上一次的断点处开始

#4.truncate删除不能回滚，delete删除可以回滚</code></pre>
                <p>##DDL语句<br>###库和表的管理<br>库的管理：</p>
                <pre><code>一、创建库
create database 库名
二、删除库
drop database 库名</code></pre>
                <p>表的管理：<br> #1.创建表</p>
                <pre><code>CREATE TABLE IF NOT EXISTS stuinfo(
    stuId INT,
    stuName VARCHAR(20),
    gender CHAR,
    bornDate DATETIME


);

DESC studentinfo;
#2.修改表 alter
语法：ALTER TABLE 表名 ADD|MODIFY|DROP|CHANGE COLUMN 字段名 【字段类型】;

#①修改字段名
ALTER TABLE studentinfo CHANGE  COLUMN sex gender CHAR;

#②修改表名
ALTER TABLE stuinfo RENAME [TO]  studentinfo;
#③修改字段类型和列级约束
ALTER TABLE studentinfo MODIFY COLUMN borndate DATE ;

#④添加字段

ALTER TABLE studentinfo ADD COLUMN email VARCHAR(20) first;
#⑤删除字段
ALTER TABLE studentinfo DROP COLUMN email;


#3.删除表

DROP TABLE [IF EXISTS] studentinfo;</code></pre>
                <p>###常见类型</p>
                <pre><code>整型：

小数：
    浮点型
    定点型
字符型：
日期型：
Blob类型：</code></pre>
                <p>###常见约束</p>
                <pre><code>NOT NULL
DEFAULT
UNIQUE
CHECK
PRIMARY KEY
FOREIGN KEY</code></pre>
                <p>##数据库事务<br>###含义<br> 通过一组逻辑操作单元（一组DML——sql语句），将数据从一种状态切换到另外一种状态</p>
                <p>###特点<br> （ACID）<br> 原子性：要么都执行，要么都回滚<br> 一致性：保证数据的状态操作前和操作后保持一致<br>
                  隔离性：多个事务同时操作相同数据库的同一个数据时，一个事务的执行不受另外一个事务的干扰<br> 持久性：一个事务一旦提交，则数据将持久化到本地，除非其他事务对其进行修改</p>
                <p>相关步骤：</p>
                <pre><code>1、开启事务
2、编写事务的一组逻辑操作单元（多条sql语句）
3、提交事务或回滚事务</code></pre>
                <p>###事务的分类：</p>
                <p>隐式事务，没有明显的开启和结束事务的标志</p>
                <pre><code>比如
insert、update、delete语句本身就是一个事务</code></pre>
                <p>显式事务，具有明显的开启和结束事务的标志</p>
                <pre><code>1、开启事务
取消自动提交事务的功能

2、编写事务的一组逻辑操作单元（多条sql语句）
insert
update
delete

3、提交事务或回滚事务</code></pre>
                <p>###使用到的关键字</p>
                <pre><code>set autocommit=0;
start transaction;
commit;
rollback;

savepoint  断点
commit to 断点
rollback to 断点</code></pre>
                <p>###事务的隔离级别:</p>
                <p>事务并发问题如何发生？</p>
                <pre><code>当多个事务同时操作同一个数据库的相同数据时</code></pre>
                <p>事务的并发问题有哪些？</p>
                <pre><code>脏读：一个事务读取到了另外一个事务未提交的数据
不可重复读：同一个事务中，多次读取到的数据不一致
幻读：一个事务读取数据时，另外一个事务进行更新，导致第一个事务读取到了没有更新的数据</code></pre>
                <p>如何避免事务的并发问题？</p>
                <pre><code>通过设置事务的隔离级别
1、READ UNCOMMITTED
2、READ COMMITTED 可以避免脏读
3、REPEATABLE READ 可以避免脏读、不可重复读和一部分幻读
4、SERIALIZABLE可以避免脏读、不可重复读和幻读</code></pre>
                <p>设置隔离级别：</p>
                <pre><code>set session|global  transaction isolation level 隔离级别名;</code></pre>
                <p>查看隔离级别：</p>
                <pre><code>select @@tx_isolation;</code></pre>
                <p>##视图<br>含义：理解成一张虚拟的表</p>
                <p>视图和表的区别：</p>
                <pre><code>    使用方式    占用物理空间

视图    完全相同    不占用，仅仅保存的是sql逻辑

表    完全相同    占用</code></pre>
                <p>视图的好处：</p>
                <pre><code>1、sql语句提高重用性，效率高
2、和表实现了分离，提高了安全性</code></pre>
                <p>###视图的创建<br> 语法：<br> CREATE VIEW 视图名<br> AS<br> 查询语句;<br>###视图的增删改查<br> 1、查看视图的数据 ★</p>
                <pre><code>SELECT * FROM my_v4;
SELECT * FROM my_v1 WHERE last_name=&apos;Partners&apos;;

2、插入视图的数据
INSERT INTO my_v4(last_name,department_id) VALUES(&apos;虚竹&apos;,90);

3、修改视图的数据

UPDATE my_v4 SET last_name =&apos;梦姑&apos; WHERE last_name=&apos;虚竹&apos;;


4、删除视图的数据
DELETE FROM my_v4;</code></pre>
                <p>###某些视图不能更新<br> 包含以下关键字的sql语句：分组函数、distinct、group by、having、union或者union all<br> 常量视图<br>
                  Select中包含子查询<br> join<br> from一个不能更新的视图<br> where子句的子查询引用了from子句中的表<br>###视图逻辑的更新<br> #方式一：<br> CREATE
                  OR REPLACE VIEW test_v7<br> AS<br> SELECT last_name FROM employees<br> WHERE employee_id&gt;100;</p>
                <pre><code>#方式二:
ALTER VIEW test_v7
AS
SELECT employee_id FROM employees;

SELECT * FROM test_v7;</code></pre>
                <p>###视图的删除<br> DROP VIEW test_v1,test_v2,test_v3;<br>###视图结构的查看<br> DESC test_v7;<br> SHOW CREATE VIEW
                  test_v7;</p>
                <p>##存储过程</p>
                <p>含义：一组经过预先编译的sql语句的集合<br>好处：</p>
                <pre><code>1、提高了sql语句的重用性，减少了开发程序员的压力
2、提高了效率
3、减少了传输次数</code></pre>
                <p>分类：</p>
                <pre><code>1、无返回无参
2、仅仅带in类型，无返回有参
3、仅仅带out类型，有返回无参
4、既带in又带out，有返回有参
5、带inout，有返回有参
注意：in、out、inout都可以在一个存储过程中带多个</code></pre>
                <p>###创建存储过程<br>语法：</p>
                <pre><code>create procedure 存储过程名(in|out|inout 参数名  参数类型,...)
begin
    存储过程体

end</code></pre>
                <p>类似于方法：</p>
                <pre><code>修饰符 返回类型 方法名(参数类型 参数名,...){

    方法体;
}</code></pre>
                <p>注意</p>
                <pre><code>1、需要设置新的结束标记
delimiter 新的结束标记
示例：
delimiter $

CREATE PROCEDURE 存储过程名(IN|OUT|INOUT 参数名  参数类型,...)
BEGIN
    sql语句1;
    sql语句2;

END $

2、存储过程体中可以有多条sql语句，如果仅仅一条sql语句，则可以省略begin end

3、参数前面的符号的意思
in:该参数只能作为输入 （该参数不能做返回值）
out：该参数只能作为输出（该参数只能做返回值）
inout：既能做输入又能做输出</code></pre>
                <p>#调用存储过程<br> call 存储过程名(实参列表)<br>##函数</p>
                <p>###创建函数</p>
                <p>学过的函数：LENGTH、SUBSTR、CONCAT等<br>语法：</p>
                <pre><code>CREATE FUNCTION 函数名(参数名 参数类型,...) RETURNS 返回类型
BEGIN
    函数体

END</code></pre>
                <p>###调用函数<br> SELECT 函数名（实参列表）</p>
                <p>###函数和存储过程的区别</p>
                <pre><code>        关键字        调用语法    返回值            应用场景
函数        FUNCTION    SELECT 函数()    只能是一个        一般用于查询结果为一个值并返回时，当有返回值而且仅仅一个
存储过程    PROCEDURE    CALL 存储过程()    可以有0个或多个        一般用于更新</code></pre>
                <p>##流程控制结构</p>
                <p>###系统变量<br>一、全局变量</p>
                <p>作用域：针对于所有会话（连接）有效，但不能跨重启</p>
                <pre><code>查看所有全局变量
SHOW GLOBAL VARIABLES;
查看满足条件的部分系统变量
SHOW GLOBAL VARIABLES LIKE &apos;%char%&apos;;
查看指定的系统变量的值
SELECT @@global.autocommit;
为某个系统变量赋值
SET @@global.autocommit=0;
SET GLOBAL autocommit=0;</code></pre>
                <p>二、会话变量</p>
                <p>作用域：针对于当前会话（连接）有效</p>
                <pre><code>查看所有会话变量
SHOW SESSION VARIABLES;
查看满足条件的部分会话变量
SHOW SESSION VARIABLES LIKE &apos;%char%&apos;;
查看指定的会话变量的值
SELECT @@autocommit;
SELECT @@session.tx_isolation;
为某个会话变量赋值
SET @@session.tx_isolation=&apos;read-uncommitted&apos;;
SET SESSION tx_isolation=&apos;read-committed&apos;;</code></pre>
                <p>###自定义变量<br>一、用户变量</p>
                <p>声明并初始化：</p>
                <pre><code>SET @变量名=值;
SET @变量名:=值;
SELECT @变量名:=值;</code></pre>
                <p>赋值：</p>
                <pre><code>方式一：一般用于赋简单的值
SET 变量名=值;
SET 变量名:=值;
SELECT 变量名:=值;


方式二：一般用于赋表 中的字段值
SELECT 字段名或表达式 INTO 变量
FROM 表;</code></pre>
                <p>使用：</p>
                <pre><code>select @变量名;</code></pre>
                <p>二、局部变量</p>
                <p>声明：</p>
                <pre><code>declare 变量名 类型 【default 值】;</code></pre>
                <p>赋值：</p>
                <pre><code>方式一：一般用于赋简单的值
SET 变量名=值;
SET 变量名:=值;
SELECT 变量名:=值;


方式二：一般用于赋表 中的字段值
SELECT 字段名或表达式 INTO 变量
FROM 表;</code></pre>
                <p>使用：</p>
                <pre><code>select 变量名</code></pre>
                <p>二者的区别：</p>
                <pre><code>作用域            定义位置        语法</code></pre>
                <p>用户变量 当前会话 会话的任何地方 加@符号，不用指定类型<br>局部变量 定义它的BEGIN END中 BEGIN END的第一句话 一般不用加@,需要指定类型</p>
                <p>###分支<br>一、if函数<br> 语法：if(条件，值1，值2)<br> 特点：可以用在任何位置</p>
                <p>二、case语句</p>
                <p>语法：</p>
                <pre><code>情况一：类似于switch
case 表达式
when 值1 then 结果1或语句1(如果是语句，需要加分号) 
when 值2 then 结果2或语句2(如果是语句，需要加分号)
...
else 结果n或语句n(如果是语句，需要加分号)
end 【case】（如果是放在begin end中需要加上case，如果放在select后面不需要）

情况二：类似于多重if
case 
when 条件1 then 结果1或语句1(如果是语句，需要加分号) 
when 条件2 then 结果2或语句2(如果是语句，需要加分号)
...
else 结果n或语句n(如果是语句，需要加分号)
end 【case】（如果是放在begin end中需要加上case，如果放在select后面不需要）</code></pre>
                <p>特点：<br> 可以用在任何位置</p>
                <p>三、if elseif语句</p>
                <p>语法：</p>
                <pre><code>if 情况1 then 语句1;
elseif 情况2 then 语句2;
...
else 语句n;
end if;</code></pre>
                <p>特点：<br> 只能用在begin end中！！！！！！！！！！！！！！！</p>
                <p>三者比较：<br> 应用场合<br> if函数 简单双分支<br> case结构 等值判断 的多分支<br> if结构 区间判断 的多分支</p>
                <p>###循环</p>
                <p>语法：</p>
                <pre><code>【标签：】WHILE 循环条件  DO
    循环体
END WHILE 【标签】;</code></pre>
                <p>特点：</p>
                <pre><code>只能放在BEGIN END里面

如果要搭配leave跳转语句，需要使用标签，否则可以不用标签

leave类似于java中的break语句，跳出所在循环！！！</code></pre>

              </div>
              <footer class="article-footer">
                <a data-url="http://yoursite.com/2019/12/07/%E3%80%90mysql%E3%80%91%202.mysql%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8(%E5%85%A8)/"
                  data-id="ck5dnjjmb0009qgts80crg6v6" class="article-share-link">Share</a>


              </footer>
            </div>

          </article>



          <article id="post-【mysql】 1.mysql基础入门" class="article article-type-post" itemscope itemprop="blogPost">
            <div class="article-meta">
              <a href="/2019/12/06/%E3%80%90mysql%E3%80%91%201.mysql%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/"
                class="article-date">
                <time datetime="2019-12-06T14:00:23.694Z" itemprop="datePublished">2019-12-06</time>
              </a>

            </div>
            <div class="article-inner">


              <header class="article-header">


                <h1 itemprop="name">
                  <a class="article-title"
                    href="/2019/12/06/%E3%80%90mysql%E3%80%91%201.mysql%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/">【mysql】
                    1.mysql基础入门</a>
                </h1>


              </header>

              <div class="article-entry" itemprop="articleBody">

                <h3 id="一、mysql基础入门"><a href="#一、mysql基础入门" class="headerlink" title="一、mysql基础入门"></a>一、mysql基础入门</h3>
                <ol>
                  <li>
                    <h4 id="常见函数"><a href="#常见函数" class="headerlink" title="常见函数"></a>常见函数</h4>
                  </li>
                </ol>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">类似与java的方法,将一组逻辑语句封装在方法体中,对外暴露方法名</span><br><span class="line">好处：隐藏了实现细节；提高代码的重用性</span><br><span class="line">调用：select 函数名(实参列表) from 表名；</span><br><span class="line">特点：叫什么（函数名）；干什么（函数功能）</span><br><span class="line">分类：1.单行函数：如-contact lenth ifnull等</span><br><span class="line">	 2.多行函数：功能:做统计使用,又称为统计函数,聚合函数,组函数</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <ul>
                  <li>单行函数：字符函数、数学函数、日期函数、其他函数、流程控制函数字符函数</li>
                </ul>
                <h5 id="字符函数："><a href="#字符函数：" class="headerlink" title="字符函数："></a>字符函数：</h5>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"># 1.length 获取参数值的字节个数</span><br><span class="line">select length(&apos;tom&apos;)	# 3</span><br><span class="line"># 2.contact 拼接字符串</span><br><span class="line">select contact(last_name,&apos;-&apos;,first_name) as 姓名 from user;</span><br><span class="line"># 3.upper、lower 大小写转换</span><br><span class="line">select upper(&apos;Tom&apos;)</span><br><span class="line">select lower(&apos;Tom&apos;)</span><br><span class="line"># 4.substr、substring 截取参数值</span><br><span class="line">select substr(string,position,length) output; # 索引从1开始</span><br><span class="line"># 5.instr	获取参数的某字符的开始位置,如果找不到返回0</span><br><span class="line">select instr(&quot;你好我是一个傻子&quot;,&apos;傻子&apos;)	#7</span><br><span class="line"># 6.trim 去掉字符串的两端空格</span><br><span class="line">select trim(&quot;  Tim    &quot;) as name;	# 去掉两端空格</span><br><span class="line">select trim(&apos;a&apos; from &apos;aaaaaaaaaaaa你好aaaaa你好aaaaaaa&apos;) as output # 去掉两端的a字符</span><br><span class="line"># 7.lpad  用指定的字符实现左填充,超过会从右截断</span><br><span class="line">select lpad(&apos;我是&apos;,10,‘*’) as output</span><br><span class="line"># 8.rpad  用指定的字符实现右填充,超过会从右截断</span><br><span class="line">select rpad(&apos;我是一个傻子&apos;,10,‘*’) as output</span><br><span class="line"># 9.replace  替换字符串</span><br><span class="line">select replace(&apos;张无忌爱上了周芷若&apos;,&apos;周芷若&apos;,&apos;赵敏&apos;)</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h5 id="数学函数："><a href="#数学函数：" class="headerlink" title="数学函数："></a>数学函数：</h5>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"># 1.round 四舍五入</span><br><span class="line">select round(1.65)		# 2</span><br><span class="line">select round(1.568,2)	# 小数点后保留两位 1.57</span><br><span class="line"># 2.ceil 向上取整(返回大于等于参数的最小整数)</span><br><span class="line">select ceil(1.00)		# 1</span><br><span class="line">select ceil(0.01)		# 1</span><br><span class="line"># 3.floor 向下取整(返回小于等于参数的最大整数)</span><br><span class="line">select floor(-9.99)     # -10</span><br><span class="line"># 4.truncate 截断</span><br><span class="line">select truncate(1.65,1) # 1.6 小数点后保留一位</span><br><span class="line"># 5.mod 取余  mod(a,b) a-a/b*b</span><br><span class="line">select mod(10,3)		# 1</span><br><span class="line">select mod(-10,-3)		# -1  被除数为正则正</span><br><span class="line">select mod(10,-3)		# 1   被除数为负则负</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h5 id="日期函数"><a href="#日期函数" class="headerlink" title="日期函数:"></a>日期函数:</h5>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"># 1.now 返回当前系统日期+时间</span><br><span class="line">select now();</span><br><span class="line"># 2.curdate 返回当前系统日期，不包含时间</span><br><span class="line">select curdate();</span><br><span class="line"># 3.curtime 返回当前时间，不包含日期</span><br><span class="line">select curtime();</span><br><span class="line"># 4.可以获取指定的部分，年，月，日，时，分，秒等等</span><br><span class="line">select year(now()) 年;</span><br><span class="line">select year(&apos;1998-01-01&apos;) 年;</span><br><span class="line">select month(&apos;1998-01-01&apos;) 月;		</span><br><span class="line">select monthname(&apos;1998-01-01&apos;) 月;	# 出现月份的英文</span><br><span class="line"># str_to_date:将日期格式的字符转换成指定格式的日期</span><br><span class="line">str_to_date(&apos;9-13-1999&apos;,&apos;%m-%d-%Y&apos;);</span><br><span class="line">%Y  4位的年份  %y 2位的年份</span><br><span class="line">%m  月份(01,02....)</span><br><span class="line">%c  月份(1,2,3....)</span><br><span class="line">%d  日(01,02...)</span><br><span class="line">%H  小时(24小时制)</span><br><span class="line">%h  小时(12小时制)</span><br><span class="line">%i  分钟(00,01,02...)</span><br><span class="line">%s  秒(00,01,02)</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>



              </div>
              <footer class="article-footer">
                <a data-url="http://yoursite.com/2019/12/06/%E3%80%90mysql%E3%80%91%201.mysql%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/"
                  data-id="ck5dnjjkq0000qgts85cb1ie6" class="article-share-link">Share</a>


              </footer>
            </div>

          </article>



          <article id="post-【PyQt5】 1.PyQt5入门学习" class="article article-type-post" itemscope itemprop="blogPost">
            <div class="article-meta">
              <a href="/2019/12/05/%E3%80%90PyQt5%E3%80%91%201.PyQt5%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0/"
                class="article-date">
                <time datetime="2019-12-05T06:25:48.808Z" itemprop="datePublished">2019-12-05</time>
              </a>

            </div>
            <div class="article-inner">


              <header class="article-header">


                <h1 itemprop="name">
                  <a class="article-title"
                    href="/2019/12/05/%E3%80%90PyQt5%E3%80%91%201.PyQt5%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0/">【PyQt5】
                    1.PyQt5入门学习</a>
                </h1>


              </header>

              <div class="article-entry" itemprop="articleBody">

                <h5 id="一、基本思路结构"><a href="#一、基本思路结构" class="headerlink" title="一、基本思路结构"></a>一、基本思路结构</h5>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment"># 1.导入需要的包和模块</span></span><br><span class="line">from PyQt5.Qt import * <span class="comment"># 主要包含了常用的包和模块</span></span><br><span class="line">import sys  <span class="comment"># 通过sys.argv可以获取参数</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.创建一个应用程序对象</span></span><br><span class="line">app = QApplication(sys.argv)</span><br><span class="line">app.arguments()     <span class="comment"># 获取参数</span></span><br><span class="line">qApp.arguments()    <span class="comment"># 全局 qApp获取参数</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.控件的操作</span></span><br><span class="line"><span class="comment"># 创建控件，设置样式，信号的处理</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.应用程序的执行，进行到 消息循环（无限循环），检测整个程序的用户操作交互</span></span><br><span class="line">app.exec_()</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>
                <h5 id="二、第一个PyQt5程序：hello-world"><a href="#二、第一个PyQt5程序：hello-world" class="headerlink"
                    title="二、第一个PyQt5程序：hello world"></a>二、第一个PyQt5程序：hello world</h5>
                <figure class="highlight python">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="keyword">from</span> PyQt5.Qt <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">app = QApplication(sys.argv)</span><br><span class="line"></span><br><span class="line">window = QWidget()</span><br><span class="line">window.setWindowTitle(<span class="string">"微博搜索助手"</span>)</span><br><span class="line">window.resize(<span class="number">500</span>,<span class="number">500</span>)</span><br><span class="line">window.move(<span class="number">400</span>,<span class="number">200</span>)</span><br><span class="line"></span><br><span class="line">label = QLabel(window)</span><br><span class="line">label.setText(<span class="string">"hello world"</span>)</span><br><span class="line">label.move(<span class="number">200</span>,<span class="number">200</span>)</span><br><span class="line"></span><br><span class="line">window.show()</span><br><span class="line">sys.exit(app.exec_())</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h6 id="封装成面向对象："><a href="#封装成面向对象：" class="headerlink" title="封装成面向对象："></a>封装成面向对象：</h6>
                <figure class="highlight python">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="keyword">from</span> PyQt5.Qt <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Window</span><span class="params">(QWidget)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        super().__init__()</span><br><span class="line">        self.setWindowTitle(<span class="string">"学习入门"</span>)</span><br><span class="line">        self.resize(<span class="number">500</span>,<span class="number">500</span>)</span><br><span class="line">        self.setup_ui()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setup_ui</span><span class="params">(self)</span>:</span></span><br><span class="line">		<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">import</span> sys</span><br><span class="line">    app = QApplication(sys.argv)</span><br><span class="line">    window = Window()</span><br><span class="line">    window.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h5 id="设置控件样式："><a href="#设置控件样式：" class="headerlink" title="设置控件样式："></a>设置控件样式：</h5>
                <figure class="highlight python">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">setup_ui</span><span class="params">(self)</span>:</span></span><br><span class="line">	<span class="comment"># 加载外部样式qss</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">"QLabel.qss"</span>,<span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        qApp.setStyleSheet(f.read())</span><br><span class="line"></span><br><span class="line">    label = QLabel(self)</span><br><span class="line">    label.setObjectName(<span class="string">"labelStyle"</span>)</span><br><span class="line">    label.setProperty(<span class="string">"notice_level"</span>,<span class="string">"warning"</span>)</span><br><span class="line">    label.setText(<span class="string">"文本设置样式"</span>)</span><br><span class="line">    <span class="comment"># 单独设置样式，优先级高于外部加载样式</span></span><br><span class="line">    <span class="comment"># label.setStyleSheet("font-size:20px;color:red;")</span></span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>
                <p>外部样式文件QLabel.qss:</p>
                <figure class="highlight css">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="selector-tag">QLabel</span><span class="selector-id">#labelStyle</span> &#123;    </span><br><span class="line">    <span class="attribute">font-size</span>:<span class="number">20</span>;</span><br><span class="line">    <span class="attribute">color</span>:yellow;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">QLabel</span><span class="selector-id">#labelStyle</span><span class="selector-attr">[notice_level="warning"]</span> &#123;    </span><br><span class="line">    <span class="attribute">font-size</span>:<span class="number">40px</span>;</span><br><span class="line">    <span class="attribute">color</span>:red;</span><br><span class="line">&#125;</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h5 id="设置控件的父子关系："><a href="#设置控件的父子关系：" class="headerlink" title="设置控件的父子关系："></a>设置控件的父子关系：</h5>
                <figure class="highlight python">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">obj1 = QObject()</span><br><span class="line">obj2 = QObject()</span><br><span class="line">obj1.setParent(obj2)	<span class="comment"># 设置obj2为obj1的父对象 一个对象的父对象只有一个，以后设置的为父对象</span></span><br><span class="line">obj1.parent()			<span class="comment"># 查看obj1的父对象</span></span><br><span class="line">obj2.children()			<span class="comment"># 查看obj2的所有的直接子对象</span></span><br><span class="line"><span class="comment"># 参数1：查找的对象类型；参数2：查找的对象名称；参数3：默认是递归查找#（Qt.FindDirectChildrenOnly- 仅查找直接子对象； Qt.FindChildrenRecursively- 递归查找 默认选项）</span></span><br><span class="line">obj1.findChild(参数<span class="number">1</span>，参数<span class="number">2</span>，参数<span class="number">3</span>)	</span><br><span class="line">obj1.findChildren(参数<span class="number">1</span>，参数<span class="number">2</span>，参数<span class="number">3</span>)	<span class="comment"># 查找所有子对象</span></span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h5 id="内存管理机制："><a href="#内存管理机制：" class="headerlink" title="内存管理机制："></a>内存管理机制：</h5>
                <p>所有的对象都是直接或者间接的继承QObject</p>
                <p>QObject在一个对象树中组织，当创建一个QObject时，如果使用了其他对象作为其父对象，那么他就会添加到父对象的children列表中</p>
                <p>当父对象被销毁时，这么QObject对象就会被销毁，其所有子对象同时也会被销毁</p>
                <p>子控件和父控件的关系：显示受父控件约束，父控件销毁子控件也会销毁</p>
                <p>如果两个控件都没有父控件，那么都会当做单独的顶级控件显示；</p>
                <p>只有顶级控件才能设置标题栏等属性信息；</p>
                <h5 id="信号与槽机制："><a href="#信号与槽机制：" class="headerlink" title="信号与槽机制："></a>信号与槽机制：</h5>
                <p> 基本概念：</p>
                <pre><code>信号（Signal）和槽（slot）是Qt中的核心机制，主要用于对象之间进行通讯

信号：当一个控件的状态发生改变时，向外界发出的信息

槽：一个执行某些操作的函数或方法

所有继承自QWidget的控件都支持信号与槽机制</code></pre>
                <p> 信号：</p>
                <pre><code>控件内置的一些 QPushButton().pressed/clicked

也可以自定义信号：</code></pre>
                <p> 槽：</p>
                <pre><code>不同控件内置的槽函数

自定义的函数方法</code></pre>
                <p> 连接方式：</p>
                <pre><code>object.信号.connect(槽函数)</code></pre>
                <p> 特性：</p>
                <pre><code>一个信号可以连接多个槽函数

一个信号也可以连接多个槽函数

信号的参数可以使任何python类型

一个槽可以监听多个信号</code></pre>
                <figure class="highlight python">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment"># 信号一 演示</span></span><br><span class="line">obj = QObject()</span><br><span class="line">obj.destroyed.connect(<span class="keyword">lambda</span> :print(<span class="string">"对象已被销毁"</span>))</span><br><span class="line"><span class="comment"># ouput：</span></span><br><span class="line"><span class="comment"># 对象已被销毁</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 信号二 演示</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change</span><span class="params">(name)</span>:</span></span><br><span class="line">	print(<span class="string">"名称发生改变"</span>,name)</span><br><span class="line">obj.objectNameChanged.connect(change)</span><br><span class="line">obj.setObjectName(<span class="string">"名称修改"</span>)</span><br><span class="line"><span class="comment"># ouput：</span></span><br><span class="line"><span class="comment"># 名称发生改变 名称修改</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 断开信号连接</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change</span><span class="params">(name)</span>:</span></span><br><span class="line">	print(<span class="string">"名称发生改变"</span>,name)</span><br><span class="line">obj.objectNameChanged.connect(change)</span><br><span class="line">obj.setObjectName(<span class="string">"名称修改1"</span>)</span><br><span class="line">obj.objectNameChanged.disconnect()</span><br><span class="line">obj.setObjectName(<span class="string">"名称修改2"</span>)</span><br><span class="line"><span class="comment"># ouput：</span></span><br><span class="line"><span class="comment"># 名称发生改变 名称修改1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 临时断开信号连接和恢复信号连接</span></span><br><span class="line">obj = QObject()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change</span><span class="params">(name)</span>:</span></span><br><span class="line">	print(<span class="string">"名称发生改变"</span>,name)</span><br><span class="line">obj.objectNameChanged.connect(change)</span><br><span class="line">obj.setObjectName(<span class="string">"名称修改1"</span>)</span><br><span class="line">obj.blockSignals(<span class="literal">True</span>)      <span class="comment"># 临时阻断信号连接</span></span><br><span class="line">obj.setObjectName(<span class="string">"名称修改2"</span>)</span><br><span class="line">obj.blockSignals(<span class="literal">False</span>)     <span class="comment"># 恢复信号连接</span></span><br><span class="line">obj.setObjectName(<span class="string">"名称修改3"</span>)</span><br><span class="line">obj.SignalsBlocked()		<span class="comment"># 查看连接状态(暂停为True,未暂停未False)</span></span><br><span class="line">obj.obj.receivers(obj.objectNameChanged)	<span class="comment"># 输出当前连接对应槽的数量:1</span></span><br><span class="line"><span class="comment"># ouput：</span></span><br><span class="line"><span class="comment"># 名称发生改变 名称修改1</span></span><br><span class="line"><span class="comment"># 名称发生改变 名称修改3</span></span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h5 id="QObject-类型判定"><a href="#QObject-类型判定" class="headerlink" title="QObject 类型判定"></a>QObject 类型判定
                </h5>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">obj = QObject()</span><br><span class="line">w = QWidget()</span><br><span class="line">btn = QPushButton()</span><br><span class="line">label = QLabel()</span><br><span class="line">objs = [obj,w,btn,label]</span><br><span class="line">for o in objs:</span><br><span class="line">	print(o.isWidgetType())		# 是否是控件类型</span><br><span class="line">	# print(o.inherits(&apos;QWidget&apos;))# 是否是控件类型</span><br><span class="line"># output:</span><br><span class="line"># False</span><br><span class="line"># True</span><br><span class="line"># True</span><br><span class="line"># True</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h5 id="对象删除-obj-deleteLater"><a href="#对象删除-obj-deleteLater" class="headerlink"
                    title="对象删除 obj.deleteLater():"></a>对象删除 obj.deleteLater():</h5>
                <ol>
                  <li>删除一个对象时，也会接触它与父对象之间的关系</li>
                  <li>并没有将对象立即销毁，而是向主消息循环发送了一个event，下次主循环循环收到这个event之后才会销毁对象</li>
                  <li>这样做额好处是可以在这些延迟删除的时间内完成一些操作，坏处就是内存释放会不及时</li>
                </ol>
                <p>应用场景：想要移除某个对象时候使用</p>
                <h5 id="定时器"><a href="#定时器" class="headerlink" title="定时器"></a>定时器</h5>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">class MyObject(QObject):</span><br><span class="line">	def timerEvent(self,evt):</span><br><span class="line">		print(evt,&quot;1&quot;)</span><br><span class="line"></span><br><span class="line">obj = MyObject()</span><br><span class="line">timer_id = obj.startTimer(1000)	# 开启定时器</span><br><span class="line">obj.killTimer(timer_id)			# 删除定时器</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>



              </div>
              <footer class="article-footer">
                <a data-url="http://yoursite.com/2019/12/05/%E3%80%90PyQt5%E3%80%91%201.PyQt5%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0/"
                  data-id="ck5dnjjla0006qgts6kyg3lnp" class="article-share-link">Share</a>


              </footer>
            </div>

          </article>



          <article id="post-【python】 1.使用虚拟环境搭建项目" class="article article-type-post" itemscope itemprop="blogPost">
            <div class="article-meta">
              <a href="/2019/12/05/%E3%80%90python%E3%80%91%201.%E4%BD%BF%E7%94%A8%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E9%A1%B9%E7%9B%AE/"
                class="article-date">
                <time datetime="2019-12-05T05:56:26.372Z" itemprop="datePublished">2019-12-05</time>
              </a>

            </div>
            <div class="article-inner">


              <header class="article-header">


                <h1 itemprop="name">
                  <a class="article-title"
                    href="/2019/12/05/%E3%80%90python%E3%80%91%201.%E4%BD%BF%E7%94%A8%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E9%A1%B9%E7%9B%AE/">【python】
                    1.使用虚拟环境搭建项目</a>
                </h1>


              </header>

              <div class="article-entry" itemprop="articleBody">

                <h4 id="pipenv安装和虚拟环境的创建"><a href="#pipenv安装和虚拟环境的创建" class="headerlink"
                    title="pipenv安装和虚拟环境的创建"></a>pipenv安装和虚拟环境的创建</h4>
                <h5 id="安装pipenv"><a href="#安装pipenv" class="headerlink" title="安装pipenv"></a>安装pipenv</h5>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">pip install pipenv -i https://pypi.douban.com/simple <span class="comment"># 采用豆瓣源全局安装</span></span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h5 id="创建虚拟环境"><a href="#创建虚拟环境" class="headerlink" title="创建虚拟环境"></a>创建虚拟环境</h5>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">pipenv --three  <span class="comment"># 采用python3作为虚拟环境编译版本</span></span><br><span class="line">pipenv shell 	<span class="comment"># 打开虚拟环境</span></span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h5 id="安装第三方包模块"><a href="#安装第三方包模块" class="headerlink" title="安装第三方包模块"></a>安装第三方包模块</h5>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">pipenv install pyqt5</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <blockquote>
                  <p>直接安装由于直接用的是国外镜像，会出现安装过慢或者安装错误的情况</p>
                  <p>解决：修改目录下Pipfile文件source下url地址：</p>
                  <p>​ 改为国内镜像地址：<a href="https://pypi.douban.com/simple" target="_blank"
                      rel="noopener">https://pypi.douban.com/simple</a> （豆瓣源）</p>
                  <p>​ <a href="https://pypi.tuna.tsinghua.edu.cn/simple" target="_blank"
                      rel="noopener">https://pypi.tuna.tsinghua.edu.cn/simple</a> （清华源）</p>
                </blockquote>


              </div>
              <footer class="article-footer">
                <a data-url="http://yoursite.com/2019/12/05/%E3%80%90python%E3%80%91%201.%E4%BD%BF%E7%94%A8%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E9%A1%B9%E7%9B%AE/"
                  data-id="ck5dnjjl40002qgts4ujxg7ni" class="article-share-link">Share</a>


              </footer>
            </div>

          </article>



          <article id="post-【php】 1.在CentOS上搭建LNMP环境" class="article article-type-post" itemscope itemprop="blogPost">
            <div class="article-meta">
              <a href="/2019/12/04/%E3%80%90php%E3%80%91%201.%E5%9C%A8CentOS%E4%B8%8A%E6%90%AD%E5%BB%BALNMP%E7%8E%AF%E5%A2%83/"
                class="article-date">
                <time datetime="2019-12-04T12:10:25.817Z" itemprop="datePublished">2019-12-04</time>
              </a>

            </div>
            <div class="article-inner">


              <header class="article-header">


                <h1 itemprop="name">
                  <a class="article-title"
                    href="/2019/12/04/%E3%80%90php%E3%80%91%201.%E5%9C%A8CentOS%E4%B8%8A%E6%90%AD%E5%BB%BALNMP%E7%8E%AF%E5%A2%83/">【php】
                    1.在CentOS上搭建LNMP环境</a>
                </h1>


              </header>

              <div class="article-entry" itemprop="articleBody">

                <h4 id="一、准备"><a href="#一、准备" class="headerlink" title="一、准备"></a>一、准备</h4>
                <h5 id="启动epel的源"><a href="#启动epel的源" class="headerlink" title="启动epel的源"></a>启动epel的源</h5>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">yum install epel-release</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h5 id="关闭SELinux"><a href="#关闭SELinux" class="headerlink" title="关闭SELinux"></a>关闭SELinux</h5>
                <blockquote>
                  <p>SELinux是严格访问模式，初学Linux建议把此功能关闭，编辑/etc/selinux/config</p>
                </blockquote>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">SELINUX = disabled  		<span class="comment"># 修改此行为disabled</span></span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>


                <h5 id="关闭SELinux之后需要重启服务器，或者直接用命令"><a href="#关闭SELinux之后需要重启服务器，或者直接用命令" class="headerlink"
                    title="关闭SELinux之后需要重启服务器，或者直接用命令"></a>关闭SELinux之后需要重启服务器，或者直接用命令</h5>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">setenforce 0</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h4 id="二、开始安装"><a href="#二、开始安装" class="headerlink" title="二、开始安装"></a>二、开始安装</h4>
                <h5 id="安装nginx-mysql-php-fast-cgi："><a href="#安装nginx-mysql-php-fast-cgi：" class="headerlink"
                    title="安装nginx,mysql,php,fast-cgi："></a>安装nginx,mysql,php,fast-cgi：</h5>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">yum install nginx mariadb-server mariadb php php-fpm php-mysql</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h5 id="启动nginx-mysql-php-fpm："><a href="#启动nginx-mysql-php-fpm：" class="headerlink"
                    title="启动nginx,mysql,php-fpm："></a>启动nginx,mysql,php-fpm：</h5>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">systemctl start nginx</span><br><span class="line">systemctl start mariadb</span><br><span class="line">systemctl start php-fpm</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h5 id="设置成开机启动："><a href="#设置成开机启动：" class="headerlink" title="设置成开机启动："></a>设置成开机启动：</h5>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">systemctl <span class="built_in">enable</span> nginx</span><br><span class="line">systemctl <span class="built_in">enable</span> mariadb</span><br><span class="line">systemctl <span class="built_in">enable</span> php-fpm</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h5 id="查看运行状态："><a href="#查看运行状态：" class="headerlink" title="查看运行状态："></a>查看运行状态：</h5>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">systemctl status nginx</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>
                <h5 id="查看端口占用状态："><a href="#查看端口占用状态：" class="headerlink" title="查看端口占用状态："></a>查看端口占用状态：</h5>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">netstat -tunlp</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h5 id="在nginx上添加新的站点："><a href="#在nginx上添加新的站点：" class="headerlink"
                    title="在nginx上添加新的站点："></a>在nginx上添加新的站点：</h5>
                <blockquote>
                  <p>编辑vim /etc/nginx/conf.d/test.com.conf，添加以下内容：</p>
                </blockquote>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">server &#123;</span><br><span class="line">	listen	80;</span><br><span class="line">	server_name	www.test.com;</span><br><span class="line">	charset	utf-8;</span><br><span class="line">	index index.php;</span><br><span class="line">	location ~ .php$ &#123;</span><br><span class="line">		fastcgi_pass	127.0.0.1:9000;</span><br><span class="line">		fastcgi_index	index.php;</span><br><span class="line">		fastcgi_param	SCRIPT_FILENAME <span class="variable">$document_root</span><span class="variable">$fastcgi_script_name</span>;</span><br><span class="line">		include fastcgi_params;</span><br><span class="line">	&#125;</span><br><span class="line">	root /var/www/www.test.com/;</span><br><span class="line">&#125;</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h5 id="创建测试文件："><a href="#创建测试文件：" class="headerlink" title="创建测试文件："></a>创建测试文件：</h5>
                <blockquote>
                  <p>站点配置好了，我们创建站点的根目录和测试文件：</p>
                </blockquote>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">mkdir /var/www/www.test.com</span><br><span class="line">touch /var/www/www.test.com/index.php</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <blockquote>
                  <p>我们修改此文件 vim /var/www/<a href="http://www.test.com/index.php：" target="_blank"
                      rel="noopener">www.test.com/index.php：</a></p>
                </blockquote>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">&lt;?php</span><br><span class="line">phpinfo();</span><br><span class="line">?&gt;</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h5 id="然后我们修改目录权限，让此目录属主为nginx："><a href="#然后我们修改目录权限，让此目录属主为nginx：" class="headerlink"
                    title="然后我们修改目录权限，让此目录属主为nginx："></a>然后我们修改目录权限，让此目录属主为nginx：</h5>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">chown -R nginx:nginx /var/www/www.test.com</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h5 id="查看nginx进程："><a href="#查看nginx进程：" class="headerlink" title="查看nginx进程："></a>查看nginx进程：</h5>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">ps aux|grep nginx</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h5 id="让nginx重新加载配置："><a href="#让nginx重新加载配置：" class="headerlink"
                    title="让nginx重新加载配置："></a>让nginx重新加载配置：</h5>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">systemctl restart nginx	<span class="comment">#用重启命令</span></span><br><span class="line">systemctl reload nginx <span class="comment">#用文件重启命令</span></span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h5 id="重启时候出现问题："><a href="#重启时候出现问题：" class="headerlink" title="##### 重启时候出现问题："></a>##### 重启时候出现问题：
                </h5>
                <blockquote>
                  <p>启动nginx提示“Job for nginx.service failed because the control process…”错误：</p>
                </blockquote>
                <blockquote>
                  <p>
                    原因：配置文件错误,nginx配置文件为<code>/etc/nginx/conf.d/*.conf</code>，也就是<code>/etc/nginx/conf.d/</code>文件夹下的所有以.conf结尾的文件，如果同时存在两个以上的配置文件，那么这两个文件是会同时生效的，也就是nginx会把两个文件的内容拼接在一起，然后当成一个文件来运行，所以，<strong>如果nginx运行出现问题，记得检查/etc/nginx/conf.d/文件夹下所有以.conf结尾的配置文件。</strong>
                  </p>
                </blockquote>
                <blockquote>
                  <p>解决：</p>
                </blockquote>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">解决办法：运行systemctl status nginx -l</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <blockquote>
                  <p>找到对应错误并修改</p>
                </blockquote>


              </div>
              <footer class="article-footer">
                <a data-url="http://yoursite.com/2019/12/04/%E3%80%90php%E3%80%91%201.%E5%9C%A8CentOS%E4%B8%8A%E6%90%AD%E5%BB%BALNMP%E7%8E%AF%E5%A2%83/"
                  data-id="ck5dnjjl10001qgts2r7q5i9j" class="article-share-link">Share</a>


              </footer>
            </div>

          </article>



          <article id="post-【svn】 1.CentOS7 的svn简单安装与使用" class="article article-type-post" itemscope
            itemprop="blogPost">
            <div class="article-meta">
              <a href="/2019/11/17/%E3%80%90svn%E3%80%91%201.CentOS7%20%E7%9A%84svn%E7%AE%80%E5%8D%95%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/"
                class="article-date">
                <time datetime="2019-11-17T12:28:48.522Z" itemprop="datePublished">2019-11-17</time>
              </a>

            </div>
            <div class="article-inner">


              <header class="article-header">


                <h1 itemprop="name">
                  <a class="article-title"
                    href="/2019/11/17/%E3%80%90svn%E3%80%91%201.CentOS7%20%E7%9A%84svn%E7%AE%80%E5%8D%95%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/">【svn】
                    1.CentOS7 的svn简单安装与使用</a>
                </h1>


              </header>

              <div class="article-entry" itemprop="articleBody">

                <h3 id="CentOS7-安装svn"><a href="#CentOS7-安装svn" class="headerlink" title="CentOS7 安装svn"></a>CentOS7
                  安装svn</h3>
                <ol>
                  <li>安装</li>
                </ol>
                <ul>
                  <li>CentOS7下yum命令即可方便的完成安装</li>
                </ul>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">$ sudo yum install subversion</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>



                <ul>
                  <li>测试安装是否成功：</li>
                </ul>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">$ svnserve --version</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>



                <ol start="2">
                  <li>建立版本库</li>
                </ol>
                <ul>
                  <li>
                    <p>创建svn数据目录（subversion默认是把/var/svn作为数据根目录的，开机启动默认也是从这里）：</p>
                    <figure class="highlight plain">
                      <table>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line">$ sudo mkdir -p /var/svn</span><br></pre>
                          </td>
                        </tr>
                      </table>
                    </figure>



                  </li>
                </ul>
                <ul>
                  <li>
                    <p>创建版本库：</p>
                    <figure class="highlight plain">
                      <table>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line">$ sudo svnadmin create /var/svn/wangwa</span><br></pre>
                          </td>
                        </tr>
                      </table>
                    </figure>





                  </li>
                </ul>
                <ul>
                  <li>如果删除版本库：</li>
                </ul>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">$ sudo rm -rf /var/svn/somnus</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>



                <ol start="3">
                  <li>配置svn配置文件</li>
                </ol>
                <p>每个版本库创建之后都会生成svnserve.conf主要配置文件。编辑它：</p>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">$ sudo vim /var/svn/somnus/conf/svnserve.conf</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <p>编辑示例：</p>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">[general]</span><br><span class="line">anon-access = none                #控制非鉴权用户访问版本库的权限</span><br><span class="line">auth-access = write                 #控制鉴权用户访问版本库的权限</span><br><span class="line">password-db = passwd           #指定用户名口令文件名</span><br><span class="line">authz-db = authz                     #指定权限配置文件名</span><br><span class="line">realm = somnus               #指定版本库的认证域，即在登录时提示的认证域名称</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>



                <ol start="4">
                  <li>编辑svn用户配置文件</li>
                </ol>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">sudo vim /var/svn/somnus/conf/passwd</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <p>编辑示例：</p>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">[users]</span><br><span class="line">admin = admin                #用户，密码</span><br><span class="line">fuhd = fuhd                #用户，密码</span><br><span class="line">test = test                #用户，密码</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>



                <ol start="5">
                  <li>编辑svn权限控制配置文件</li>
                </ol>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">sudo vim /var/svn/somnus/conf/authz</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <p>编辑示例：</p>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">[groups]</span><br><span class="line">admin = admin         #admin为用户组,等号之后的admin为用户</span><br><span class="line">test = fuhd,test</span><br><span class="line"></span><br><span class="line">[somnus:/]                #表示根目录（/var/svn/somnus），somnus: 对应前面配置的realm = somnus</span><br><span class="line">@admin = rw            ＃表示admin组对根目录有读写权限,r为读，w为写</span><br><span class="line"></span><br><span class="line">[somnus:/test]         #表示test目录（/var/svn/somnus/test）</span><br><span class="line">@test = rw                #表示test组对test目录有读写权限</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>



                <ol start="6">
                  <li>启动，查看和停止SVN服务</li>
                </ol>
                <ul>
                  <li>
                    <p>启动SVN服务：</p>
                    <figure class="highlight plain">
                      <table>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line">#-d : 守护进程  -r : svn数据根目录 </span><br><span class="line">$ sudo svnserve -dr /var/svn            #用root权限启动</span><br></pre>
                          </td>
                        </tr>
                      </table>
                    </figure>





                  </li>
                </ul>
                <ul>
                  <li>查看SVN服务：</li>
                </ul>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">$ ps aux|grep svns erve               #默认端口为：3690</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>



                <ol start="7">
                  <li>配置防火墙端口</li>
                </ol>
                <p>首先要明确CentOS7的默认防火墙为firewallD。subversion的默认端口为3690，如果没有打开会报错：</p>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">$ sudo firewall-cmd --permanent -add-port=3690/tcp</span><br><span class="line"> $ sudo firewall-cmd --reload</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>




                <ol start="8">
                  <li>检索项目和切换项目的url</li>
                </ol>
                <ul>
                  <li>项目检错</li>
                </ul>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">$ svn checkout svn://192.168.0.112/XK_Project . #使用 checkout  服务器资源 本地目录</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <ul>
                  <li>切换项目url</li>
                </ul>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">$ svn switch --relocate svn://192.168.0.112/XK_Project svn://192.168.0.120/XK_Project   # 使用 switch 迁移 from  to 新的地址</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>




                <ol start="9">
                  <li>设置开机启动</li>
                </ol>
                <p>在centos7， 设置开机启动：</p>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">$ sudo systemctl enable svnserve.service      #注意：根目录必须是/var/svn 这样才能设置成功！！</span><br><span class="line">#设置开机启动后就可以按下面的方式开启或停止服务了</span><br><span class="line">$ sudo systemctl start svnserve.service</span><br><span class="line">$ sudo systemctl stop svnserve.service</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <p>临时关闭：</p>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">$ sudo setenforce 0</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <p>永久关闭：</p>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">$ sudo vim /etc/sysconfig/selinux</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>


                <p>修改：</p>
                <figure class="highlight plain">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">SELINUX = disable               #值修改为disable.</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>




              </div>
              <footer class="article-footer">
                <a data-url="http://yoursite.com/2019/11/17/%E3%80%90svn%E3%80%91%201.CentOS7%20%E7%9A%84svn%E7%AE%80%E5%8D%95%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/"
                  data-id="ck5dnjjl80005qgts71ut4zse" class="article-share-link">Share</a>


              </footer>
            </div>

          </article>



          <article id="post-【scrapy】 2.scrapy进阶学习之随机请求头、随机代理和数据异步存储" class="article article-type-post" itemscope
            itemprop="blogPost">
            <div class="article-meta">
              <a href="/2019/11/12/%E3%80%90scrapy%E3%80%91%202.scrapy%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E4%B9%8B%E9%9A%8F%E6%9C%BA%E8%AF%B7%E6%B1%82%E5%A4%B4%E3%80%81%E9%9A%8F%E6%9C%BA%E4%BB%A3%E7%90%86%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BC%82%E6%AD%A5%E5%AD%98%E5%82%A8/"
                class="article-date">
                <time datetime="2019-11-12T12:49:02.922Z" itemprop="datePublished">2019-11-12</time>
              </a>

            </div>
            <div class="article-inner">


              <header class="article-header">


                <h1 itemprop="name">
                  <a class="article-title"
                    href="/2019/11/12/%E3%80%90scrapy%E3%80%91%202.scrapy%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E4%B9%8B%E9%9A%8F%E6%9C%BA%E8%AF%B7%E6%B1%82%E5%A4%B4%E3%80%81%E9%9A%8F%E6%9C%BA%E4%BB%A3%E7%90%86%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BC%82%E6%AD%A5%E5%AD%98%E5%82%A8/">【scrapy】
                    2.scrapy进阶学习之随机请求头、随机代理和数据异步存储</a>
                </h1>


              </header>

              <div class="article-entry" itemprop="articleBody">

                <p>使用scrapy框架完成图片的爬取</p>
                <h2 id="一、设置随机请求头中间件"><a href="#一、设置随机请求头中间件" class="headerlink" title="一、设置随机请求头中间件"></a>一、设置随机请求头中间件
                </h2>
                <h3 id="修改middlewares-py中间件内容"><a href="#修改middlewares-py中间件内容" class="headerlink"
                    title="修改middlewares.py中间件内容"></a>修改middlewares.py中间件内容</h3>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">import random</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编写（重写）download中间件</span></span><br><span class="line">class BmwimagesDownloaderMiddleware(object):</span><br><span class="line">    <span class="comment"># Not all methods need to be defined. If a method is not defined,</span></span><br><span class="line">    <span class="comment"># scrapy acts as if the downloader middleware does not modify the</span></span><br><span class="line">    <span class="comment"># passed objects.</span></span><br><span class="line"></span><br><span class="line">    USER_AGENT = &#123;</span><br><span class="line">        <span class="string">'Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; Acoo Browser 1.98.744; .NET CLR 3.5.30729)'</span>,</span><br><span class="line">        <span class="string">'Chrome (AppleWebKit/537.1; Chrome50.0; Windows NT 6.3) AppleWebKit/537.36 (KHTML like Gecko) Chrome/51.0.2704.79 Safari/537.36 Edge/14.14393'</span>,</span><br><span class="line">        <span class="string">'Cyberdog/2.0 (Macintosh; 68k)'</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    def process_request(self, request, spider):</span><br><span class="line"></span><br><span class="line">        user_agent = random.choice(self.USER_AGENT)</span><br><span class="line">        request.headers[<span class="string">'User-Agent'</span>] = user_agent</span><br><span class="line"></span><br><span class="line">        <span class="built_in">return</span> None</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h3 id="settings-py开启下载中间件"><a href="#settings-py开启下载中间件" class="headerlink"
                    title="settings.py开启下载中间件"></a>settings.py开启下载中间件</h3>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">DOWNLOADER_MIDDLEWARES = &#123;</span><br><span class="line">   <span class="string">'BmwImages.middlewares.BmwimagesDownloaderMiddleware'</span>: 543,</span><br><span class="line">&#125;</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h2 id="二、设置随机代理中间件"><a href="#二、设置随机代理中间件" class="headerlink" title="二、设置随机代理中间件"></a>二、设置随机代理中间件</h2>
                <h3 id="修改middlewares-py中间件内容-1"><a href="#修改middlewares-py中间件内容-1" class="headerlink"
                    title="修改middlewares.py中间件内容"></a>修改middlewares.py中间件内容</h3>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">import random</span><br><span class="line">def process_request(self, request, spider):</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 设置IP代理中间件</span></span><br><span class="line">    <span class="comment"># 如果购买的是代理ip，会得到代理ip及端口列表</span></span><br><span class="line">    proxy_list = []</span><br><span class="line">    proxy = random.choice(proxy_list)</span><br><span class="line">    request.meta[<span class="string">'proxy'</span>] = proxy</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h3 id="settings-py开启下载中间件-1"><a href="#settings-py开启下载中间件-1" class="headerlink"
                    title="settings.py开启下载中间件"></a>settings.py开启下载中间件</h3>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">DOWNLOADER_MIDDLEWARES = &#123;</span><br><span class="line">   <span class="string">'BmwImages.middlewares.BmwimagesDownloaderMiddleware'</span>: 543,</span><br><span class="line">&#125;</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>


                <h3 id="爬取数据存入数据库"><a href="#爬取数据存入数据库" class="headerlink" title="爬取数据存入数据库"></a>爬取数据存入数据库</h3>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">import pymysql</span><br><span class="line"></span><br><span class="line">class JsPipeline(object):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        dbparams = &#123;</span><br><span class="line">            <span class="string">'host'</span>: <span class="string">'127.0.0.1'</span>,</span><br><span class="line">            <span class="string">'port'</span>: 3306,</span><br><span class="line">            <span class="string">'user'</span>: <span class="string">'root'</span>,</span><br><span class="line">            <span class="string">'password'</span>: <span class="string">'root'</span>,</span><br><span class="line">            <span class="string">'database'</span>: <span class="string">'jianshu'</span>,</span><br><span class="line">            <span class="string">'charset'</span>: <span class="string">'utf8'</span></span><br><span class="line">        &#125;</span><br><span class="line">        self.conn = pymysql.connect(**dbparams)</span><br><span class="line">        self.cursor = self.conn.cursor()</span><br><span class="line"></span><br><span class="line">    def process_item(self, item, spider):</span><br><span class="line">        sql = <span class="string">"INSERT INTO `article` (`title`) VALUES ('%s')"</span>%item[<span class="string">'title'</span>]</span><br><span class="line">        self.cursor.execute(sql)</span><br><span class="line">        self.conn.commit()</span><br><span class="line">        <span class="built_in">return</span> item</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h3 id="修改成爬取异步存储"><a href="#修改成爬取异步存储" class="headerlink" title="修改成爬取异步存储"></a>修改成爬取异步存储</h3>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">from pymysql import cursors</span><br><span class="line">from twisted.enterprise import adbapi</span><br><span class="line"></span><br><span class="line">class JsTwistedPipeline(object):</span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        dbparams = &#123;</span><br><span class="line">            <span class="string">'host'</span>: <span class="string">'127.0.0.1'</span>,</span><br><span class="line">            <span class="string">'port'</span>: 3306,</span><br><span class="line">            <span class="string">'user'</span>: <span class="string">'root'</span>,</span><br><span class="line">            <span class="string">'password'</span>: <span class="string">'root'</span>,</span><br><span class="line">            <span class="string">'database'</span>: <span class="string">'jianshu'</span>,</span><br><span class="line">            <span class="string">'charset'</span>: <span class="string">'utf8'</span>,</span><br><span class="line">            <span class="string">'cursorclass'</span>:cursors.DictCursor</span><br><span class="line">        &#125;</span><br><span class="line">        self.dbpool = adbapi.ConnectionPool(<span class="string">'pymysql'</span>,**dbparams)</span><br><span class="line"></span><br><span class="line">    def process_item(self, item, spider):</span><br><span class="line">        sql = <span class="string">"INSERT INTO `article` (`title`) VALUES ('%s')"</span>%item[<span class="string">'title'</span>]</span><br><span class="line">        defer = self.dbpool.runInteraction(self.insert_item,item)</span><br><span class="line">        defer.addErrback(self.handle_error,item,spider)</span><br><span class="line">        <span class="built_in">return</span> item</span><br><span class="line"></span><br><span class="line">    def insert_item(self,cursor,item):</span><br><span class="line">        sql = <span class="string">"INSERT INTO `article` (`title`) VALUES ('%s')"</span>%item[<span class="string">'title'</span>]</span><br><span class="line">        cursor.execute(sql)</span><br><span class="line"></span><br><span class="line">    def handle_error(self,error,item,spider):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">'='</span>*10+<span class="string">"error"</span>+<span class="string">"="</span>*10)</span><br><span class="line">        <span class="built_in">print</span>(error)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">'='</span>*10+<span class="string">"error"</span>+<span class="string">"="</span>*10)</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h3 id="使用selenium-webdriver爬取ajax请求的数据"><a href="#使用selenium-webdriver爬取ajax请求的数据" class="headerlink"
                    title="使用selenium+webdriver爬取ajax请求的数据"></a>使用selenium+webdriver爬取ajax请求的数据</h3>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">from selenium import webdriver</span><br><span class="line">from scrapy.http import HtmlResponse</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">class JsSeleniumWebDriverMiddleware(object):</span><br><span class="line"></span><br><span class="line">    def __init__(self):</span><br><span class="line">        driver_path = r<span class="string">"D:\python\scrapy\study\20191009\chromedriver\chromedriver2-0.exe"</span></span><br><span class="line">        self.driver = webdriver.Chrome(executable_path=driver_path)</span><br><span class="line"></span><br><span class="line">    def process_request(self, request, spider):</span><br><span class="line">        self.driver.get(request.url)</span><br><span class="line">        time.sleep(1)</span><br><span class="line">        try:</span><br><span class="line">            <span class="keyword">while</span> True:</span><br><span class="line">                showmore = self.driver.find_element_by_xpath(<span class="string">"更多"</span>)</span><br><span class="line">                showmore.click()</span><br><span class="line">                time.sleep(0.3)</span><br><span class="line">                <span class="keyword">if</span> not showmore:</span><br><span class="line">                    <span class="built_in">break</span></span><br><span class="line">        except:</span><br><span class="line">            pass</span><br><span class="line"></span><br><span class="line">        <span class="built_in">source</span> = self.driver.page_source</span><br><span class="line">        response = HtmlResponse(url=self.driver.current_url,body=<span class="built_in">source</span>,request=request,encoding=<span class="string">'utf-8'</span>)</span><br><span class="line">        <span class="built_in">return</span> response</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h3 id="开启selenium-webdriver中间件"><a href="#开启selenium-webdriver中间件" class="headerlink"
                    title="开启selenium+webdriver中间件"></a>开启selenium+webdriver中间件</h3>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">DOWNLOADER_MIDDLEWARES = &#123;</span><br><span class="line">   <span class="string">'BmwImages.middlewares.JsSeleniumWebDriverMiddleware'</span>: 543,</span><br><span class="line">&#125;</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

              </div>
              <footer class="article-footer">
                <a data-url="http://yoursite.com/2019/11/12/%E3%80%90scrapy%E3%80%91%202.scrapy%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E4%B9%8B%E9%9A%8F%E6%9C%BA%E8%AF%B7%E6%B1%82%E5%A4%B4%E3%80%81%E9%9A%8F%E6%9C%BA%E4%BB%A3%E7%90%86%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BC%82%E6%AD%A5%E5%AD%98%E5%82%A8/"
                  data-id="ck5dnjjl70004qgts1yyv1he9" class="article-share-link">Share</a>


              </footer>
            </div>

          </article>



          <article id="post-【scrapy】 1.使用scrapy框架高效爬取汽车之家图片" class="article article-type-post" itemscope
            itemprop="blogPost">
            <div class="article-meta">
              <a href="/2019/11/12/%E3%80%90scrapy%E3%80%91%201.%E4%BD%BF%E7%94%A8scrapy%E6%A1%86%E6%9E%B6%E9%AB%98%E6%95%88%E7%88%AC%E5%8F%96%E6%B1%BD%E8%BD%A6%E4%B9%8B%E5%AE%B6%E5%9B%BE%E7%89%87/"
                class="article-date">
                <time datetime="2019-11-12T12:38:31.278Z" itemprop="datePublished">2019-11-12</time>
              </a>

            </div>
            <div class="article-inner">


              <header class="article-header">


                <h1 itemprop="name">
                  <a class="article-title"
                    href="/2019/11/12/%E3%80%90scrapy%E3%80%91%201.%E4%BD%BF%E7%94%A8scrapy%E6%A1%86%E6%9E%B6%E9%AB%98%E6%95%88%E7%88%AC%E5%8F%96%E6%B1%BD%E8%BD%A6%E4%B9%8B%E5%AE%B6%E5%9B%BE%E7%89%87/">【scrapy】
                    1.使用scrapy框架高效爬取汽车之家图片</a>
                </h1>


              </header>

              <div class="article-entry" itemprop="articleBody">

                <p>使用scrapy框架完成图片的爬取</p>
                <h2 id="一、项目基础配置"><a href="#一、项目基础配置" class="headerlink" title="一、项目基础配置"></a>一、项目基础配置</h2>
                <h3 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h3>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">scrapy startproject BmwImages</span><br><span class="line"><span class="built_in">cd</span> BmwImages</span><br><span class="line">scrapy genspider bmwSpider car.autohome.com.cn</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h3 id="修改基础配置"><a href="#修改基础配置" class="headerlink" title="修改基础配置"></a>修改基础配置</h3>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">* settings中ROBOTSTXT_OBEY</span><br><span class="line">* DEFAULT_REQUEST_HEADERS</span><br><span class="line">* USER_AGENT</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h3 id="增加start-py启动爬虫文件"><a href="#增加start-py启动爬虫文件" class="headerlink"
                    title="增加start.py启动爬虫文件"></a>增加start.py启动爬虫文件</h3>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">from scrapy import cmdline</span><br><span class="line">cmdline.execute(<span class="string">"scrapy crawl bmwSpider"</span>.split())</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h2 id="二、爬取图片数据"><a href="#二、爬取图片数据" class="headerlink" title="二、爬取图片数据"></a>二、爬取图片数据</h2>
                <h3 id="获取图片类别名称和urls列表"><a href="#获取图片类别名称和urls列表" class="headerlink"
                    title="获取图片类别名称和urls列表"></a>获取图片类别名称和urls列表</h3>
                <figure class="highlight python">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line"><span class="keyword">from</span> BmwImages.items <span class="keyword">import</span> BmwimagesItem</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BmwspiderSpider</span><span class="params">(scrapy.Spider)</span>:</span></span><br><span class="line">    name = <span class="string">'bmwSpider'</span></span><br><span class="line">    allowed_domains = [<span class="string">'car.autohome.com.cn'</span>]</span><br><span class="line">    start_urls = [<span class="string">'https://car.autohome.com.cn/pic/series/66.html'</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse</span><span class="params">(self, response)</span>:</span></span><br><span class="line">        uiboxs = response.xpath(<span class="string">"//div[@class='uibox']"</span>)[<span class="number">1</span>:]</span><br><span class="line">        <span class="keyword">for</span> uibox <span class="keyword">in</span> uiboxs:</span><br><span class="line">            category = uibox.xpath(<span class="string">".//div[@class='uibox-title']/a/text()"</span>).get()</span><br><span class="line">            urls = uibox.xpath(<span class="string">".//div//ul/li/a/img/@src"</span>).getall()</span><br><span class="line">            image_urls = list(map(<span class="keyword">lambda</span> x:parse.urljoin(response.url,x.replace(<span class="string">"240x180_0_q95_c42_"</span>,<span class="string">""</span>)),urls))</span><br><span class="line">            item = BmwimagesItem(category=category,image_urls=image_urls)</span><br><span class="line">            <span class="keyword">yield</span> item</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h3 id="设置图片管道下载"><a href="#设置图片管道下载" class="headerlink" title="设置图片管道下载"></a>设置图片管道下载</h3>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">import scrapy</span><br><span class="line"></span><br><span class="line">class BmwimagesItem(scrapy.Item):</span><br><span class="line">    category = scrapy.Field()</span><br><span class="line">    image_urls = scrapy.Field()</span><br><span class="line">    images = scrapy.Field()</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h3 id="settings-py代码"><a href="#settings-py代码" class="headerlink"
                    title="settings.py代码"></a>settings.py代码</h3>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">import os</span><br><span class="line"></span><br><span class="line">ITEM_PIPELINES = &#123;</span><br><span class="line">   <span class="comment"># 'BmwImages.pipelines.BmwimagesPipeline': 300,</span></span><br><span class="line">  <span class="string">'scrapy.pipelines.images.ImagesPipeline'</span>: 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">IMAGES_STORE = os.path.join(os.path.dirname(os.path.dirname(__file__)),<span class="string">'images'</span>)</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>


                <h3 id="重写方法设置目录"><a href="#重写方法设置目录" class="headerlink" title="重写方法设置目录"></a>重写方法设置目录</h3>
                <figure class="highlight python">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> scrapy.pipelines.images <span class="keyword">import</span> ImagesPipeline</span><br><span class="line"><span class="keyword">from</span> BmwImages <span class="keyword">import</span> settings</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BmwImagesPipeline</span><span class="params">(ImagesPipeline)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 请求下载之前调用 发送下载请求</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_media_requests</span><span class="params">(self, item, info)</span>:</span></span><br><span class="line">        request_objs = super(BmwImagesPipeline,self).get_media_requests(item, info)</span><br><span class="line">        <span class="keyword">for</span> request_obj <span class="keyword">in</span> request_objs:</span><br><span class="line">            request_obj.item = item</span><br><span class="line">        <span class="keyword">return</span> request_objs</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 请求之后调用 图片将要被存储时调用获取路径</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">file_path</span><span class="params">(self, request, response=None, info=None)</span>:</span></span><br><span class="line">        path = super(BmwImagesPipeline, self).file_path(request, response, info)</span><br><span class="line">        category = request.item.get(<span class="string">'category'</span>)</span><br><span class="line">        image_store = settings.IMAGES_STORE</span><br><span class="line">        category_path = os.path.join(image_store,category)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(category_path):</span><br><span class="line">            os.mkdir(category_path)</span><br><span class="line"></span><br><span class="line">        image_name = path.replace(<span class="string">"full/"</span>,<span class="string">""</span>)</span><br><span class="line">        image_path = os.path.join(category_path,image_name)</span><br><span class="line">        <span class="keyword">return</span> image_path</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>

                <h3 id="使用crawlSpider进行改进，爬取更多图片"><a href="#使用crawlSpider进行改进，爬取更多图片" class="headerlink"
                    title="使用crawlSpider进行改进，爬取更多图片"></a>使用crawlSpider进行改进，爬取更多图片</h3>
                <figure class="highlight bash">
                  <table>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line">import scrapy</span><br><span class="line">from urllib import parse</span><br><span class="line">from BmwImages.items import BmwimagesItem</span><br><span class="line">from scrapy.spiders import CrawlSpider, Rule</span><br><span class="line">from scrapy.linkextractors import LinkExtractor</span><br><span class="line"></span><br><span class="line">class BmwspiderSpider(CrawlSpider):</span><br><span class="line">    name = <span class="string">'bmwCrawlSpider'</span></span><br><span class="line">    allowed_domains = [<span class="string">'car.autohome.com.cn'</span>]</span><br><span class="line">    start_urls = [<span class="string">'https://car.autohome.com.cn/pic/series/66.html'</span>]</span><br><span class="line"></span><br><span class="line">    rules = &#123;</span><br><span class="line">        Rule(LinkExtractor(allow=r<span class="string">"https://car.autohome.com.cn/pic/series/66.+"</span>),callback=<span class="string">"parse_images"</span>,follow=True),</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    def parse_images(self,response):</span><br><span class="line">        category = response.xpath(<span class="string">"//div[@class='uibox-title']/text()"</span>).getall()</span><br><span class="line">        category = <span class="string">""</span>.join(category).split()</span><br><span class="line">        srcs = response.xpath(<span class="string">"//div[contains(@class,'uibox-con')]/ul/li//img/@src"</span>).getall()</span><br><span class="line">        srcs = list(map(lambda x:parse.urljoin(response.url,x.replace(<span class="string">"240x180_0_q95_c42_"</span>,<span class="string">"1024x0_1_q95_"</span>)),srcs))</span><br><span class="line">        <span class="keyword">if</span> len(category) != 0:</span><br><span class="line">            yield BmwimagesItem(category=category[0], image_urls=srcs)</span><br></pre>
                      </td>
                    </tr>
                  </table>
                </figure>


              </div>
              <footer class="article-footer">
                <a data-url="http://yoursite.com/2019/11/12/%E3%80%90scrapy%E3%80%91%201.%E4%BD%BF%E7%94%A8scrapy%E6%A1%86%E6%9E%B6%E9%AB%98%E6%95%88%E7%88%AC%E5%8F%96%E6%B1%BD%E8%BD%A6%E4%B9%8B%E5%AE%B6%E5%9B%BE%E7%89%87/"
                  data-id="ck5dnjjl50003qgtsgo0632th" class="article-share-link">Share</a>


              </footer>
            </div>

          </article>





        </section>

        <aside id="sidebar">










          <div class="widget-wrap">
            <h3 class="widget-title">Archives</h3>
            <div class="widget">
              <ul class="archive-list">
                <li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a>
                </li>
                <li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a>
                </li>
                <li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a>
                </li>
              </ul>
            </div>
          </div>




          <div class="widget-wrap">
            <h3 class="widget-title">Recent Posts</h3>
            <div class="widget">
              <ul>

                <li>
                  <a
                    href="/2020/01/14/%E3%80%90%E9%9D%A2%E8%AF%95%E3%80%91%201.php%E9%9D%A2%E8%AF%95%EF%BC%88%E4%B8%80%EF%BC%89/">【面试】
                    1.php面试（一）</a>
                </li>

                <li>
                  <a href="/2019/12/13/%E3%80%90%E8%BF%90%E7%BB%B4%E3%80%91%201.%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0/">【运维】
                    1.入门学习</a>
                </li>

                <li>
                  <a
                    href="/2019/12/07/%E3%80%90mysql%E3%80%91%202.mysql%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8(%E5%85%A8)/">【mysql】
                    2.mysql基础入门(全)</a>
                </li>

                <li>
                  <a href="/2019/12/06/%E3%80%90mysql%E3%80%91%201.mysql%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/">【mysql】
                    1.mysql基础入门</a>
                </li>

                <li>
                  <a href="/2019/12/05/%E3%80%90PyQt5%E3%80%91%201.PyQt5%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0/">【PyQt5】
                    1.PyQt5入门学习</a>
                </li>

              </ul>
            </div>
          </div>


        </aside>

      </div>
      <footer id="footer">

        <div class="outer">
          <div id="footer-info" class="inner">
            &copy; 2020 David Xiang<br>
            Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
          </div>
        </div>
      </footer>
    </div>
    <nav id="mobile-nav">

      <a href="/" class="mobile-nav-link">Home</a>

      <a href="/archives" class="mobile-nav-link">Archives</a>

    </nav>


    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


    <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
    <script src="/fancybox/jquery.fancybox.pack.js"></script>


    <script src="/js/script.js"></script>



  </div>
</body>

</html>